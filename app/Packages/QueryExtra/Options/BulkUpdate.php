<?php
bolt_decrypt( __FILE__ , '4jNOwN'); return 0;
##!!!##CgpuYW1lc3BhY2UgQXBwXFBhY2thZ2VzXFF1ZXJ5RXh0cmFcT3B0aW9uczsKCnVzZSBBcHBcUGFja2FnZXNcUXVlcnlFeHRyYVxFeGNlcHRpb25zXEludmFsaWRUYWJsZTsKdXNlIEFwcFxQYWNrYWdlc1xRdWVyeUV4dHJhXEV4Y2VwdGlvbnNcSW52YWxpZEtleTsKdXNlIEFwcFxQYWNrYWdlc1xRdWVyeUV4dHJhXEV4Y2VwdGlvbnNcSW52YWxpZERhdGE7CgpjbGFzcyBCdWxrVXBkYXRlIAp7CiAgICAvKioKICAgICAqIG1ha2UgdXBkYXRlIHF1ZXJ5CiAgICAgKgogICAgICogQHJldHVybiBzdHJpbmcgJHF1ZXJ5CiAgICAgKi8KCgoJcHVibGljIHN0YXRpYyBmdW5jdGlvbiBtYWtlKCR0YWJsZSwka2V5LCBhcnJheSAkdXBkYXRlKTogc3RyaW5nCiAgICB7CiAgICAgICAgaWYgKGlzX251bGwoJHRhYmxlKSkgCiAgICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkVGFibGUoJ3RhYmxlKCkgaXMgbWlzc2luZycpOwogICAgICAgIAogICAgICAgIGlmIChpc19udWxsKCRrZXkpKQogICAgICAgICAgICB0aHJvdyBuZXcgSW52YWxpZEtleSgnd2hlcmVLZXkoKSBpcyBtaXNzaW5nJyk7CiAgICAgICAgCiAgICAgICAgaWYgKGVtcHR5KCR1cGRhdGUpKQogICAgICAgICAgICB0aHJvdyBuZXcgSW52YWxpZERhdGEoJ05vIGRhdGEgZm91bmQhJyk7CgogICAgCSRhcnIgICA9IGNvbGxlY3QoJHVwZGF0ZSktPnBsdWNrKCdrZXl2YWwnKS0+dG9BcnJheSgpOwogICAgICAgICRhcnIgICA9IGltcGxvZGUoJywgJywkYXJyKTsKICAgIAkkY2FzZSAgPSBzZWxmOjpjb25kaXRpb24oJHVwZGF0ZSwgJGtleSk7CgogICAgICAgIC8vIHJhdyBzcWwgcXVlcnkgZm9yIGJ1bGsgdXBkYXRlCiAgICAJcmV0dXJuICJ1cGRhdGUgJHRhYmxlIHNldCAiLiRjYXNlLiIgd2hlcmUgJGtleSBpbiAoIi4kYXJyLiIpIjsKCiAgICAJCiAgICB9CgogIAogICAgLyoqCiAgICAgKiBnZXQgY29uZGl0aW9uYWwgY2FzZSBzdGF0ZW1lbnQKICAgICAqCiAgICAgKiBAcmV0dXJuIHN0cmluZyAkcXVlcnkKICAgICAqLwogICAgcHJpdmF0ZSBzdGF0aWMgZnVuY3Rpb24gY29uZGl0aW9uKGFycmF5ICR1cGRhdGUsICRrZXkpCiAgICB7CiAgICAgICAgZm9yZWFjaCAoJHVwZGF0ZSBhcyAkayA9PiAkdmFsKSB7CiAgICAgICAgICAgIAogICAgICAgICAgICBpZiAoIWlzc2V0KCR2YWxbJ2tleXZhbCddKSkKICAgICAgICAgICAgICAgIHRocm93IG5ldyBJbnZhbGlkS2V5KCdObyB2YWx1ZSBhc3NpZ25lZCB0byB0aGUga2V5IGBrZXl2YWxgJyk7CiAgICAgICAgICAgIAogICAgICAgICAgICAkY29sdW1uID0gJHZhbFsna2V5dmFsJ107CiAgICAgICAgICAgIGZvcmVhY2ggKCR2YWxbJ2RhdGEnXSBhcyAkazEgPT4gJHYpIHsKICAgICAgICAgICAgICAgICRjYXNlc1skazFdW10gPSAgIndoZW4gJGNvbHVtbiB0aGVuICciLiR2LiInIjsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHNlbGY6OmNhc2UoJGNhc2VzLCAka2V5KTsKICAgIH0KCiAgICAvKioKICAgICAqIGJ1aWxkIGNhc2Ugc3RhdGVtZW50CiAgICAgKgogICAgICogQHJldHVybiBzdHJpbmcgJHF1ZXJ5CiAgICAgKi8KCiAgICBwcml2YXRlIHN0YXRpYyBmdW5jdGlvbiBjYXNlKGFycmF5ICRjYXNlcywgJGtleSkKICAgIHsKICAgICAgICBmb3JlYWNoICgkY2FzZXMgYXMgJGsgPT4gJHYpIHsKICAgICAgICAgICAgJHNbJGtdID0gJGsuIiA9IGNhc2UgJGtleSAiLmltcGxvZGUoIiAiLCR2KS4iIGVuZCI7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gaW1wbG9kZSgnLCAnLCAkcyk7CiAgICB9CiAgICAKfQ==