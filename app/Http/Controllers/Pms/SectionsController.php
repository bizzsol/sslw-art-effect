<?php
bolt_decrypt( __FILE__ , 'ih2RRY'); return 0;
##!!!##CgpuYW1lc3BhY2UgQXBwXEh0dHBcQ29udHJvbGxlcnNcUG1zOwoKdXNlIEFwcFxIdHRwXENvbnRyb2xsZXJzXENvbnRyb2xsZXI7CnVzZSBDYWNoZSwgREI7CnVzZSBDYXJib25cQ2FyYm9uOwp1c2UgSWxsdW1pbmF0ZVxEYXRhYmFzZVxFbG9xdWVudFxCdWlsZGVyOwp1c2UgSWxsdW1pbmF0ZVxIdHRwXFJlcXVlc3Q7CnVzZSBBcHBcTW9kZWxzXFBtc01vZGVsc1xSZXF1aXNpdGlvbjsKdXNlIEFwcFxNb2RlbHNcUG1zTW9kZWxzXE5vdGlmaWNhdGlvbjsKdXNlIEFwcFxNb2RlbHNcUG1zTW9kZWxzXFJlcXVpc2l0aW9uRGVsaXZlcnlJdGVtOwp1c2UgQXBwXE1vZGVsc1xQbXNNb2RlbHNcR3JuXEdvb2RzUmVjZWl2ZWRJdGVtU3RvY2tJbjsKdXNlIEFwcFxNb2RlbHNcUG1zTW9kZWxzXFB1cmNoYXNlXFB1cmNoYXNlT3JkZXI7CnVzZSBBcHBcTW9kZWxzXFBtc01vZGVsc1xSZnBcUmVxdWVzdFByb3Bvc2FsOwp1c2UgQXBwXE1vZGVsc1xQbXNNb2RlbHNcUXVvdGF0aW9uczsKdXNlIEFwcFxNb2RlbHNcUG1zTW9kZWxzXFF1b3RhdGlvbnNJdGVtczsKdXNlIEFwcFxNb2RlbHNcVXNlckNvbHVtblZpc2liaWxpdHk7CnVzZSBBcHBcTW9kZWxzXFN5c3RlbUluZm9ybWF0aW9uOwp1c2UgQXBwXE1vZHVsZTsKdXNlIEFwcFxNb2RlbHNcSHJcVW5pdDsKdXNlIEFwcFxNb2RlbHNcSHJcRGVwYXJ0bWVudDsKdXNlIEFwcFxNb2RlbHNcSHJcU2VjdGlvbjsKdXNlIEF1dGgsIERhdGFUYWJsZXM7CgpjbGFzcyBTZWN0aW9uc0NvbnRyb2xsZXIgZXh0ZW5kcyBDb250cm9sbGVyCnsgIAogICAgcHVibGljIGZ1bmN0aW9uIGhlYWRlckNvbHVtbnMoKQogICAgewogICAgICAgIHJldHVybiAgYXJyYXkoCiAgICAgICAgICAgIFsnU0wnLCAnU0wnLCAndGV4dC1jZW50ZXInXSwKICAgICAgICAgICAgWydTQlUnLCAnU0JVJ10sCiAgICAgICAgICAgIFsnZGVwYXJ0bWVudCcsICdkZXBhcnRtZW50J10sCiAgICAgICAgICAgIFsnc2VjdGlvbl9jb2RlJywgJ3NlY3Rpb25fY29kZScsICd0ZXh0LWNlbnRlciddLAogICAgICAgICAgICBbJ3NlY3Rpb25fbmFtZScsICdzZWN0aW9uX25hbWUnLCAndGV4dC1jZW50ZXInXSwKICAgICAgICAgICAgWydhY3Rpb25zJywgJ2FjdGlvbnMnLCAndGV4dC1jZW50ZXInXSwKICAgICAgICApOwogICAgfQogICAgCiAgICBwdWJsaWMgZnVuY3Rpb24gaW5kZXgoUmVxdWVzdCAkcmVxdWVzdCkKICAgIHsKICAgICAgICAvKgogICAgICAgICAgICAkZGVwYXJ0bWVudHMgPSBEZXBhcnRtZW50Ojpkb2VzbnRIYXZlKCdzZWN0aW9ucycpLT5nZXQoKTsKICAgICAgICAgICAgaWYoJGRlcGFydG1lbnRzLT5jb3VudCgpID4gMCl7CiAgICAgICAgICAgICAgICBmb3JlYWNoKCRkZXBhcnRtZW50cyBhcyAka2V5ID0+ICRkZXBhcnRtZW50KXsKICAgICAgICAgICAgICAgICAgICBTZWN0aW9uOjp1cGRhdGVPckNyZWF0ZShbCiAgICAgICAgICAgICAgICAgICAgICAgICdocl9zZWN0aW9uX2RlcGFydG1lbnRfaWQnID0+ICRkZXBhcnRtZW50LT5ocl9kZXBhcnRtZW50X2lkLAogICAgICAgICAgICAgICAgICAgICAgICAnaHJfc2VjdGlvbl9uYW1lJyA9PiAkZGVwYXJ0bWVudC0+aHJfZGVwYXJ0bWVudF9uYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAnaHJfc2VjdGlvbl9uYW1lX2JuJyA9PiAkZGVwYXJ0bWVudC0+aHJfZGVwYXJ0bWVudF9uYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAnaHJfc2VjdGlvbl9jb2RlJyA9PiAkZGVwYXJ0bWVudC0+aHJfZGVwYXJ0bWVudF9jb2RlLAogICAgICAgICAgICAgICAgICAgIF0sIFsKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgXSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuICdvayc7CiAgICAgICAgKi8KICAgICAgICAKICAgICAgICB0cnkgewogICAgICAgICAgICBpZiAocmVxdWVzdCgpLT5hamF4KCkpIHsKICAgICAgICAgICAgICAgIHJldHVybiBEYXRhdGFibGVzOjpvZigKICAgICAgICAgICAgICAgICAgICAgICAgU2VjdGlvbjo6d2l0aChbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGVwYXJ0bWVudC51bml0JwogICAgICAgICAgICAgICAgICAgICAgICBdKQogICAgICAgICAgICAgICAgICAgICAgICAtPndoZXJlSGFzKCdkZXBhcnRtZW50LnVuaXQnLCBmdW5jdGlvbigkcXVlcnkpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmVJbignY29tcGFueV9pZCcsIGF1dGgoKS0+dXNlcigpLT5jb21wYW5pZXMtPnBsdWNrKCdjb21wYW55X2lkJyktPnRvQXJyYXkoKSk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgICAgIC0+d2hlcmVJbignaHJfc2VjdGlvbl9pZCcsIGF1dGgoKS0+dXNlcigpLT5wcmlvcml0aWVzLT5wbHVjaygnaHJfc2VjdGlvbl9pZCcpLT50b0FycmF5KCkpCiAgICAgICAgICAgICAgICAgICAgKQogICAgICAgICAgICAgICAgICAgIC0+YWRkSW5kZXhDb2x1bW4oKQoKICAgICAgICAgICAgICAgICAgICAtPmFkZENvbHVtbignU0JVJywgZnVuY3Rpb24oJHNlY3Rpb24pewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIGlzc2V0KCRzZWN0aW9uLT5kZXBhcnRtZW50LT51bml0LT5ocl91bml0X25hbWUpID8gJ1snLiRzZWN0aW9uLT5kZXBhcnRtZW50LT51bml0LT5ocl91bml0X2NvZGUuJ10gJy4kc2VjdGlvbi0+ZGVwYXJ0bWVudC0+dW5pdC0+aHJfdW5pdF9uYW1lIDogJyc7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAtPmZpbHRlckNvbHVtbignU0JVJywgZnVuY3Rpb24gKCRxdWVyeSwgJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmVIYXMoJ2RlcGFydG1lbnQudW5pdCcsIGZ1bmN0aW9uICgkcXVlcnkpIHVzZSgka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHF1ZXJ5LT53aGVyZSgnaHJfdW5pdF9jb2RlJywgJ0xJS0UnLCAnJScuJGtleXdvcmQuJyUnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLT5vcldoZXJlKCdocl91bml0X25hbWUnLCAnTElLRScsICclJy4ka2V5d29yZC4nJScpOwogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+b3JkZXJDb2x1bW4oJ1NCVScsIGZ1bmN0aW9uICgkcXVlcnksICRvcmRlcikgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gcGxlYXNlU29ydE1lKCRxdWVyeSwgJG9yZGVyLCBEZXBhcnRtZW50OjpzZWxlY3QoJ2hyX3VuaXQuaHJfdW5pdF9jb2RlJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0+am9pbignaHJfdW5pdCcsICdocl91bml0LmhyX3VuaXRfaWQnLCAnPScsICAnaHJfZGVwYXJ0bWVudC5ocl91bml0X2lkJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0+d2hlcmVDb2x1bW4oJ2hyX2RlcGFydG1lbnQuaHJfZGVwYXJ0bWVudF9pZCcsICdocl9zZWN0aW9uLmhyX3NlY3Rpb25fZGVwYXJ0bWVudF9pZCcpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtPnRha2UoMSkKICAgICAgICAgICAgICAgICAgICAgICAgKTsKICAgICAgICAgICAgICAgICAgICB9KQoKICAgICAgICAgICAgICAgICAgICAtPmFkZENvbHVtbignZGVwYXJ0bWVudCcsIGZ1bmN0aW9uKCRzZWN0aW9uKXsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICBpc3NldCgkc2VjdGlvbi0+ZGVwYXJ0bWVudC0+aHJfZGVwYXJ0bWVudF9uYW1lKSA/ICdbJy4kc2VjdGlvbi0+ZGVwYXJ0bWVudC0+aHJfZGVwYXJ0bWVudF9jb2RlLiddICcuJHNlY3Rpb24tPmRlcGFydG1lbnQtPmhyX2RlcGFydG1lbnRfbmFtZSA6ICcnOwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgLT5maWx0ZXJDb2x1bW4oJ2RlcGFydG1lbnQnLCBmdW5jdGlvbiAoJHF1ZXJ5LCAka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZUhhcygnZGVwYXJ0bWVudCcsIGZ1bmN0aW9uICgkcXVlcnkpIHVzZSgka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgJHF1ZXJ5LT53aGVyZSgnaHJfZGVwYXJ0bWVudF9uYW1lJywgJ0xJS0UnLCAnJScuJGtleXdvcmQuJyUnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLT5vcldoZXJlKCdocl9kZXBhcnRtZW50X2NvZGUnLCAnTElLRScsICclJy4ka2V5d29yZC4nJScpOwogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+b3JkZXJDb2x1bW4oJ2RlcGFydG1lbnQnLCBmdW5jdGlvbiAoJHF1ZXJ5LCAkb3JkZXIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBsZWFzZVNvcnRNZSgkcXVlcnksICRvcmRlciwgRGVwYXJ0bWVudDo6c2VsZWN0KCdocl9kZXBhcnRtZW50LmhyX2RlcGFydG1lbnRfY29kZScpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtPndoZXJlQ29sdW1uKCdocl9kZXBhcnRtZW50LmhyX2RlcGFydG1lbnRfaWQnLCAnaHJfc2VjdGlvbi5ocl9zZWN0aW9uX2RlcGFydG1lbnRfaWQnKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgLT50YWtlKDEpCiAgICAgICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAtPmFkZENvbHVtbignc2VjdGlvbl9jb2RlJywgZnVuY3Rpb24oJHNlY3Rpb24pewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHNlY3Rpb24tPmhyX3NlY3Rpb25fY29kZTsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+ZmlsdGVyQ29sdW1uKCdzZWN0aW9uX2NvZGUnLCBmdW5jdGlvbiAoJHF1ZXJ5LCAka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZSgnaHJfc2VjdGlvbl9jb2RlJywgJ0xJS0UnLCAnJScuJGtleXdvcmQuJyUnKTsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+b3JkZXJDb2x1bW4oJ3NlY3Rpb25fY29kZScsIGZ1bmN0aW9uICgkcXVlcnksICRvcmRlcikgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT5vcmRlcmJ5KCdocl9zZWN0aW9uX2NvZGUnLCAkb3JkZXIpOwogICAgICAgICAgICAgICAgICAgIH0pCgogICAgICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdzZWN0aW9uX25hbWUnLCBmdW5jdGlvbigkc2VjdGlvbil7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkc2VjdGlvbi0+aHJfc2VjdGlvbl9uYW1lOwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgLT5maWx0ZXJDb2x1bW4oJ3NlY3Rpb25fbmFtZScsIGZ1bmN0aW9uICgkcXVlcnksICRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlKCdocl9zZWN0aW9uX25hbWUnLCAnTElLRScsICclJy4ka2V5d29yZC4nJScpOwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgLT5vcmRlckNvbHVtbignc2VjdGlvbl9uYW1lJywgZnVuY3Rpb24gKCRxdWVyeSwgJG9yZGVyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPm9yZGVyYnkoJ2hyX3NlY3Rpb25fbmFtZScsICRvcmRlcik7CiAgICAgICAgICAgICAgICAgICAgfSkKCiAgICAgICAgICAgICAgICAgICAgLT5hZGRDb2x1bW4oJ2FjdGlvbnMnLCBmdW5jdGlvbigkc2VjdGlvbil7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAnPGEgaHJlZj0iJy51cmwoJ3Btcy9zZWN0aW9ucy8nLiRzZWN0aW9uLT5ocl9zZWN0aW9uX2lkLicvZWRpdCcpLiciIGNsYXNzPSJidG4gYnRuLWluZm8gYnRuLXhzIj48aSBjbGFzcz0ibGEgbGEtZWRpdCI+PC9pPjwvYT48YSBjbGFzcz0iYnRuIGJ0bi14cyBidG4tZGFuZ2VyIG1sLTIiIG9uY2xpY2s9ImRlbGV0ZUZyb21DUlVEKCQodGhpcykpIiBkYXRhLXNyYz0iJy5yb3V0ZSgncG1zLnNlY3Rpb25zLmRlc3Ryb3knLCAkc2VjdGlvbi0+aHJfc2VjdGlvbl9pZCkuJyI+PGkgY2xhc3M9ImxhIGxhLXRyYXNoIj48L2k+PC9hPic7CiAgICAgICAgICAgICAgICAgICAgfSkKCiAgICAgICAgICAgICAgICAgICAgLT5yYXdDb2x1bW5zKFsnYWN0aW9ucyddKQogICAgICAgICAgICAgICAgICAgIC0+bWFrZSh0cnVlKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgcmV0dXJuIHZpZXcoJ3Btcy5iYWNrZW5kLnBhZ2VzLnNlY3Rpb25zLmluZGV4JywgWwogICAgICAgICAgICAgICAgJ3RpdGxlJyA9PiAnU2VjdGlvbnMnLAogICAgICAgICAgICAgICAgJ2hlYWRlckNvbHVtbnMnID0+ICR0aGlzLT5oZWFkZXJDb2x1bW5zKCkKICAgICAgICAgICAgXSk7CiAgICAgICAgfWNhdGNoIChcVGhyb3dhYmxlICR0aCl7CiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+YmFja1dpdGhFcnJvcigkdGgtPmdldE1lc3NhZ2UoKSk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBjcmVhdGUoUmVxdWVzdCAkcmVxdWVzdCkKICAgIHsKICAgICAgICBpZihyZXF1ZXN0KCktPmhhcygnZ2V0LWRlcGFydG1lbnRzJykpewogICAgICAgICAgICByZXR1cm4gRGVwYXJ0bWVudDo6d2hlcmUoJ2hyX3VuaXRfaWQnLCByZXF1ZXN0KCktPmdldCgnaHJfdW5pdF9pZCcpKS0+Z2V0KCk7CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gdmlldygncG1zLmJhY2tlbmQucGFnZXMuc2VjdGlvbnMuY3JlYXRlJywgWwogICAgICAgICAgICAndGl0bGUnID0+ICJDcmVhdGUgU2VjdGlvbiIsCiAgICAgICAgICAgICd1bml0cycgPT4gVW5pdDo6YWxsKCkKICAgICAgICBdKTsKICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gc3RvcmUoUmVxdWVzdCAkcmVxdWVzdCkKICAgIHsKICAgICAgICAkdGhpcy0+dmFsaWRhdGUoJHJlcXVlc3QsIFsKICAgICAgICAgICAgJ2hyX3NlY3Rpb25fZGVwYXJ0bWVudF9pZCcgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgJ2hyX3NlY3Rpb25fY29kZScgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgJ2hyX3NlY3Rpb25fbmFtZScgPT4gJ3JlcXVpcmVkJywKICAgICAgICBdKTsKCiAgICAgICAgREI6OmJlZ2luVHJhbnNhY3Rpb24oKTsKICAgICAgICB0cnl7CiAgICAgICAgICAgICRzZWN0aW9uID0gbmV3IFNlY3Rpb24oKTsKICAgICAgICAgICAgJHNlY3Rpb24tPmZpbGwoJHJlcXVlc3QtPmFsbCgpKTsKICAgICAgICAgICAgJHNlY3Rpb24tPmhyX3NlY3Rpb25fbmFtZV9ibiA9ICRyZXF1ZXN0LT5ocl9zZWN0aW9uX25hbWU7CiAgICAgICAgICAgICRzZWN0aW9uLT5zYXZlKCk7CgogICAgICAgICAgICBEQjo6Y29tbWl0KCk7CiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+YmFja1dpdGhTdWNjZXNzKCdTZWN0aW9uIENyZWF0ZWQgc3VjY2Vzc2Z1bGx5Jyk7CiAgICAgICAgfWNhdGNoIChcRXhjZXB0aW9uICRlKXsKICAgICAgICAgICAgREI6OnJvbGxiYWNrKCk7CiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+YmFja1dpdGhFcnJvcigkZS0+Z2V0TWVzc2FnZSgpKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIGVkaXQoJGlkKQogICAgewogICAgICAgIHJldHVybiB2aWV3KCdwbXMuYmFja2VuZC5wYWdlcy5zZWN0aW9ucy5lZGl0JywgWwogICAgICAgICAgICAndGl0bGUnID0+ICJFZGl0IFNlY3Rpb24iLAogICAgICAgICAgICAnc2VjdGlvbicgPT4gU2VjdGlvbjo6ZmluZE9yRmFpbCgkaWQpLAogICAgICAgICAgICAndW5pdHMnID0+IFVuaXQ6OmFsbCgpCiAgICAgICAgXSk7CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIHVwZGF0ZShSZXF1ZXN0ICRyZXF1ZXN0LCAkaWQpCiAgICB7CiAgICAgICAgJHRoaXMtPnZhbGlkYXRlKCRyZXF1ZXN0LCBbCiAgICAgICAgICAgICdocl9zZWN0aW9uX2RlcGFydG1lbnRfaWQnID0+ICdyZXF1aXJlZCcsCiAgICAgICAgICAgICdocl9zZWN0aW9uX2NvZGUnID0+ICdyZXF1aXJlZCcsCiAgICAgICAgICAgICdocl9zZWN0aW9uX25hbWUnID0+ICdyZXF1aXJlZCcsCiAgICAgICAgXSk7CgogICAgICAgIERCOjpiZWdpblRyYW5zYWN0aW9uKCk7CiAgICAgICAgdHJ5ewogICAgICAgICAgICAkc2VhcmNoID0gU2VjdGlvbjo6d2hlcmUoZnVuY3Rpb24oJHF1ZXJ5KSB1c2UoJHJlcXVlc3QpewogICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ2hyX3NlY3Rpb25fY29kZScsICRyZXF1ZXN0LT5ocl9zZWN0aW9uX2NvZGUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLT5vcldoZXJlKCdocl9zZWN0aW9uX25hbWUnLCAkcmVxdWVzdC0+aHJfc2VjdGlvbl9uYW1lKTsKICAgICAgICAgICAgfSkKICAgICAgICAgICAgLT53aGVyZSgnaHJfc2VjdGlvbl9pZCcsICchPScsICRpZCkKICAgICAgICAgICAgLT5maXJzdCgpOwogICAgICAgICAgICBpZihpc3NldCgkc2VhcmNoLT5ocl9zZWN0aW9uX2lkKSl7CiAgICAgICAgICAgICAgICByZXR1cm4gJHRoaXMtPmJhY2tXaXRoRXJyb3IoIlNlY3Rpb24gQWxyZWFkeSBFeGlzdHMuIik7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgICRzZWN0aW9uID0gU2VjdGlvbjo6ZmluZCgkaWQpOwogICAgICAgICAgICAkc2VjdGlvbi0+ZmlsbCgkcmVxdWVzdC0+YWxsKCkpOwogICAgICAgICAgICAkc2VjdGlvbi0+aHJfc2VjdGlvbl9uYW1lX2JuID0gJHJlcXVlc3QtPmhyX3NlY3Rpb25fbmFtZTsKICAgICAgICAgICAgJHNlY3Rpb24tPnNhdmUoKTsKCiAgICAgICAgICAgIERCOjpjb21taXQoKTsKICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5iYWNrV2l0aFN1Y2Nlc3MoJ1NlY3Rpb24gVXBkYXRlZCBzdWNjZXNzZnVsbHknKTsKICAgICAgICB9Y2F0Y2ggKFxFeGNlcHRpb24gJGUpewogICAgICAgICAgICBEQjo6cm9sbGJhY2soKTsKICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5iYWNrV2l0aEVycm9yKCRlLT5nZXRNZXNzYWdlKCkpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gZGVzdHJveSgkaWQpCiAgICB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgU2VjdGlvbjo6d2hlcmUoJ2hyX3NlY3Rpb25faWQnLCAkaWQpLT5kZWxldGUoKTsKICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlKCktPmpzb24oWwogICAgICAgICAgICAgICAgJ3N1Y2Nlc3MnID0+IHRydWUKICAgICAgICAgICAgXSk7CiAgICAgICAgfWNhdGNoIChcVGhyb3dhYmxlICR0aCl7CiAgICAgICAgICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKFsKICAgICAgICAgICAgICAgICdzdWNjZXNzJyA9PiB0cnVlLAogICAgICAgICAgICAgICAgJ21lc3NhZ2UnID0+ICR0aC0+Z2V0TWVzc2FnZSgpCiAgICAgICAgICAgIF0pOwogICAgICAgIH0KICAgIH0KfQo=