<?php
bolt_decrypt( __FILE__ , 'enKXS7'); return 0;
##!!!##CgpuYW1lc3BhY2UgQXBwXEh0dHBcQ29udHJvbGxlcnNcUG1zOwoKdXNlIEFwcFxIdHRwXENvbnRyb2xsZXJzXENvbnRyb2xsZXI7CnVzZSBBcHBcTW9kZWxzXFBtc01vZGVsc1xCcmFuZDsKdXNlIElsbHVtaW5hdGVcSHR0cFxSZXF1ZXN0Owp1c2UgSW50ZXJ2ZW50aW9uXEltYWdlXEZhY2FkZXNcSW1hZ2U7CnVzZSBEQjsKCnVzZSBBcHBcSW1wb3J0c1xCcmFuZHNJbXBvcnQ7CnVzZSBNYWF0d2Vic2l0ZVxFeGNlbFxGYWNhZGVzXEV4Y2VsOwoKY2xhc3MgQnJhbmRDb250cm9sbGVyIGV4dGVuZHMgQ29udHJvbGxlcgp7CiAgICAvKioKICAgICAqIERpc3BsYXkgYSBsaXN0aW5nIG9mIHRoZSByZXNvdXJjZS4KICAgICAqCiAgICAgKiBAcmV0dXJuIFxJbGx1bWluYXRlXEh0dHBcUmVzcG9uc2UKICAgICAqLwogICAgcHVibGljIGZ1bmN0aW9uIGluZGV4KCkKICAgIHsKICAgICAgICB0cnkgewogICAgICAgICAgICAkdGl0bGUgPSAnQnJhbmRzJzsKICAgICAgICAgICAgcmV0dXJuIHZpZXcoJ3Btcy5iYWNrZW5kLnBhZ2VzLmJyYW5kLmluZGV4JywgY29tcGFjdCgndGl0bGUnKSk7CiAgICAgICAgfWNhdGNoIChcVGhyb3dhYmxlICR0aCl7CiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+YmFja1dpdGhFcnJvcigkdGgtPmdldE1lc3NhZ2UoKSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogU2hvdyB0aGUgZm9ybSBmb3IgY3JlYXRpbmcgYSBuZXcgcmVzb3VyY2UuCiAgICAgKgogICAgICogQHJldHVybiBcSWxsdW1pbmF0ZVxIdHRwXFJlc3BvbnNlCiAgICAgKi8KICAgIHB1YmxpYyBmdW5jdGlvbiBjcmVhdGUoKQogICAgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgICRkYXRhID0gWwogICAgICAgICAgICAgICAgJ3N0YXR1cycgPT4gJ3N1Y2Nlc3MnLAogICAgICAgICAgICAgICAgJ2luZm8nID0+IEJyYW5kOjphbGwoKQogICAgICAgICAgICBdOwogICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UoKS0+anNvbigkZGF0YSk7CiAgICAgICAgfWNhdGNoIChcVGhyb3dhYmxlICR0aCl7CiAgICAgICAgICAgICRkYXRhID0gWwogICAgICAgICAgICAgICAgJ3N0YXR1cycgPT4gbnVsbCwKICAgICAgICAgICAgICAgICdpbmZvJyA9PiAkdGgtPmdldE1lc3NhZ2UoKQogICAgICAgICAgICBdOwogICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UoKS0+anNvbigkZGF0YSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogU3RvcmUgYSBuZXdseSBjcmVhdGVkIHJlc291cmNlIGluIHN0b3JhZ2UuCiAgICAgKgogICAgICogQHBhcmFtICBcSWxsdW1pbmF0ZVxIdHRwXFJlcXVlc3QgICRyZXF1ZXN0CiAgICAgKiBAcmV0dXJuIFxJbGx1bWluYXRlXEh0dHBcUmVzcG9uc2UKICAgICAqLwogICAgcHVibGljIGZ1bmN0aW9uIHN0b3JlKFJlcXVlc3QgJHJlcXVlc3QpCiAgICB7Ci8vICAgICAgICByZXR1cm4gcmVzcG9uc2UoKS0+anNvbigpOwogICAgICAgIGlmICgkcmVxdWVzdC0+aGFzKCdicmFuZHNyYycpKXsKLy8gICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UoKS0+anNvbigpOwogICAgICAgICAgICByZXR1cm4gJHRoaXMtPnVwbG9hZFdpdGhJbWFnZSgkcmVxdWVzdC0+YWxsKCkpOwovLyAgICAgICAgICAgIHJldHVybiByZWRpcmVjdCh1cmwoJHJlcXVlc3QtPmJyYW5kc3JjKSk7CiAgICAgICAgfQogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGlmICgkcmVxdWVzdC0+aGFzRmlsZSgnaW1hZ2UnKSkgewogICAgICAgICAgICAgICAgJGltYWdlID0gJHJlcXVlc3QtPmltYWdlOwogICAgICAgICAgICAgICAgJHggPSAnYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5JzsKICAgICAgICAgICAgICAgICR4ID0gc3RyX3NodWZmbGUoJHgpOwogICAgICAgICAgICAgICAgJHggPSBzdWJzdHIoJHgsIDAsIDYpIC4gJ0RBQy4nOwogICAgICAgICAgICAgICAgJGZpbGVuYW1lID0gdGltZSgpIC4gJHggLiAkaW1hZ2UtPmdldENsaWVudE9yaWdpbmFsRXh0ZW5zaW9uKCk7CiAgICAgICAgICAgICAgICBJbWFnZTo6bWFrZSgkaW1hZ2UtPmdldFJlYWxQYXRoKCkpCiAgICAgICAgICAgICAgICAtPnNhdmUocHVibGljX3BhdGgoJy91cGxvYWQvYnJhbmRzLycgLiAkZmlsZW5hbWUpKTsKICAgICAgICAgICAgICAgICRwYXRoID0gIi91cGxvYWQvYnJhbmRzLyIgLiAkZmlsZW5hbWU7CiAgICAgICAgICAgICAgICAkZGF0YVsnZmlsZV9uYW1lJ10gPSAkcmVxdWVzdC0+aW1hZ2UtPmdldENsaWVudE9yaWdpbmFsTmFtZSgpOwogICAgICAgICAgICAgICAgJGRhdGFbJ2ltYWdlJ10gPSAkcGF0aDsKICAgICAgICAgICAgfQogICAgICAgICAgICAkZGF0YVsnY29kZSddID0gJHJlcXVlc3QtPmNvZGU7CiAgICAgICAgICAgICRkYXRhWyduYW1lJ10gPSAkcmVxdWVzdC0+bmFtZTsKCiAgICAgICAgICAgICRicmFuZCA9IEJyYW5kOjpjcmVhdGUoJGRhdGEpOwoKICAgICAgICAgICAgJGRhdGEgPSBbCiAgICAgICAgICAgICAgICAnc3RhdHVzJyA9PiAnc3VjY2VzcyBzdG9yZScsCiAgICAgICAgICAgICAgICAnaW5mbycgPT4gWyRicmFuZF0KICAgICAgICAgICAgXTsKICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlKCktPmpzb24oJGRhdGEpOwogICAgICAgIH1jYXRjaCAoXFRocm93YWJsZSAkdGgpewogICAgICAgICAgICAkZGF0YSA9IFsKICAgICAgICAgICAgICAgICdzdGF0dXMnID0+IG51bGwsCiAgICAgICAgICAgICAgICAnaW5mbycgPT4gJHRoLT5nZXRNZXNzYWdlKCkKICAgICAgICAgICAgXTsKICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlKCktPmpzb24oJGRhdGEpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIERpc3BsYXkgdGhlIHNwZWNpZmllZCByZXNvdXJjZS4KICAgICAqCiAgICAgKiBAcGFyYW0gIGludCAgJGlkCiAgICAgKiBAcmV0dXJuIFxJbGx1bWluYXRlXEh0dHBcUmVzcG9uc2UKICAgICAqLwogICAgcHVibGljIGZ1bmN0aW9uIHNob3coQnJhbmQgJGJyYW5kKQogICAgewogICAgICAgIHRyeSB7CiAgICAgICAgICAgICRkYXRhID0gWwogICAgICAgICAgICAgICAgJ3N0YXR1cycgPT4gJ3N1Y2Nlc3MnLAogICAgICAgICAgICAgICAgJ2luZm8nID0+ICRicmFuZAogICAgICAgICAgICBdOwogICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UoKS0+anNvbigkZGF0YSk7CiAgICAgICAgfWNhdGNoIChcVGhyb3dhYmxlICR0aCl7CiAgICAgICAgICAgICRkYXRhID0gWwogICAgICAgICAgICAgICAgJ3N0YXR1cycgPT4gbnVsbCwKICAgICAgICAgICAgICAgICdpbmZvJyA9PiAkdGgtPmdldE1lc3NhZ2UoKQogICAgICAgICAgICBdOwogICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UoKS0+anNvbigkZGF0YSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogU2hvdyB0aGUgZm9ybSBmb3IgZWRpdGluZyB0aGUgc3BlY2lmaWVkIHJlc291cmNlLgogICAgICoKICAgICAqIEBwYXJhbSAgaW50ICAkaWQKICAgICAqIEByZXR1cm4gXElsbHVtaW5hdGVcSHR0cFxSZXNwb25zZQogICAgICovCiAgICBwdWJsaWMgZnVuY3Rpb24gZWRpdCgkaWQpCiAgICB7CiAgICAgICAgLy8KICAgIH0KCiAgICAvKioKICAgICAqIFVwZGF0ZSB0aGUgc3BlY2lmaWVkIHJlc291cmNlIGluIHN0b3JhZ2UuCiAgICAgKgogICAgICogQHBhcmFtICBcSWxsdW1pbmF0ZVxIdHRwXFJlcXVlc3QgICRyZXF1ZXN0CiAgICAgKiBAcGFyYW0gIGludCAgJGlkCiAgICAgKiBAcmV0dXJuIFxJbGx1bWluYXRlXEh0dHBcUmVzcG9uc2UKICAgICAqLwogICAgcHVibGljIGZ1bmN0aW9uIHVwZGF0ZShSZXF1ZXN0ICRyZXF1ZXN0LCAkaWQpCiAgICB7ICAgCiAgICAgICAgJGJyYW5kPUJyYW5kOjpmaW5kT3JGYWlsKCRpZCk7CgogICAgICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKCRyZXF1ZXN0LT5hbGwoKSk7CgogICAgICAgIHRyeXsKICAgICAgICAgICBpZiAoJHJlcXVlc3QtPmhhc0ZpbGUoJ2ltYWdlJykpIHsKICAgICAgICAgICAgICAgaWYgKCFlbXB0eSgkYnJhbmQtPmltYWdlKSl7CiAgICAgICAgICAgICAgICAgICBpZiAoZmlsZV9leGlzdHMocHVibGljX3BhdGgoJGJyYW5kLT5pbWFnZSkpKXsKICAgICAgICAgICAgICAgICAgICAgICB1bmxpbmsocHVibGljX3BhdGgoJGJyYW5kLT5pbWFnZSkpOwogICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAkaW1hZ2UgPSAkcmVxdWVzdC0+aW1hZ2U7CiAgICAgICAgICAgICAgICAkeCA9ICdhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5ejAxMjM0NTY3ODknOwogICAgICAgICAgICAgICAgJHggPSBzdHJfc2h1ZmZsZSgkeCk7CiAgICAgICAgICAgICAgICAkeCA9IHN1YnN0cigkeCwgMCwgNikgLiAnREFDLic7CiAgICAgICAgICAgICAgICAkZmlsZW5hbWUgPSB0aW1lKCkgLiAkeCAuICRpbWFnZS0+Z2V0Q2xpZW50T3JpZ2luYWxFeHRlbnNpb24oKTsKICAgICAgICAgICAgICAgIEltYWdlOjptYWtlKCRpbWFnZS0+Z2V0UmVhbFBhdGgoKSkKICAgICAgICAgICAgICAgIC0+c2F2ZShwdWJsaWNfcGF0aCgnL3VwbG9hZC9icmFuZHMvJyAuICRmaWxlbmFtZSkpOwogICAgICAgICAgICAgICAgJHBhdGggPSAiL3VwbG9hZC9icmFuZHMvIiAuICRmaWxlbmFtZTsKICAgICAgICAgICAgICAgICRkYXRhWydmaWxlX25hbWUnXSA9ICRyZXF1ZXN0LT5pbWFnZS0+Z2V0Q2xpZW50T3JpZ2luYWxOYW1lKCk7CiAgICAgICAgICAgICAgICAkZGF0YVsnaW1hZ2UnXSA9ICRwYXRoOwogICAgICAgICAgIH0KICAgICAgICAgICAkZGF0YVsnY29kZSddID0gJHJlcXVlc3QtPmNvZGU7CiAgICAgICAgICAgJGRhdGFbJ25hbWUnXSA9ICRyZXF1ZXN0LT5uYW1lOwoKICAgICAgICAgICAkYnJhbmQtPnVwZGF0ZSgkZGF0YSk7CgogICAgICAgICAgICAkZGF0YSA9IFsKICAgICAgICAgICAgICAgICdzdGF0dXMnID0+ICdzdWNjZXNzJywKICAgICAgICAgICAgICAgICdpbmZvJyA9PiAkcmVxdWVzdC0+YWxsKCksCiAgICAgICAgICAgICAgICAnaW5nbycgPT4gJGJyYW5kCiAgICAgICAgICAgIF07CiAgICAgICAgICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKCRkYXRhKTsKICAgICAgICB9Y2F0Y2ggKFxUaHJvd2FibGUgJHRoKXsKICAgICAgICAgICAgJGRhdGEgPSBbCiAgICAgICAgICAgICAgICAnc3RhdHVzJyA9PiBudWxsLAogICAgICAgICAgICAgICAgJ2luZm8nID0+ICR0aC0+Z2V0TWVzc2FnZSgpCiAgICAgICAgICAgIF07CiAgICAgICAgICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKCRkYXRhKTsKICAgICAgICB9CiAgICB9CgogICAgcHVibGljIGZ1bmN0aW9uIHVwbG9hZFdpdGhJbWFnZSgkaW5wdXRzKXsKCiAgICAgICAgJGlkID0gc3RyX3JlcGxhY2UoJy9wbXMvcHJvZHVjdC1tYW5hZ2VtZW50L2JyYW5kLycsJycsJGlucHV0c1snYnJhbmRzcmMnXSk7CiAgICAgICAgJGJyYW5kPUJyYW5kOjpmaW5kT3JGYWlsKCRpZCk7Ci8vICAgICAgICByZXR1cm4gcmVzcG9uc2UoKS0+anNvbigkaW5wdXRzWydpbWFnZSddKTsKCiAgICAgICAgdHJ5ewogICAgICAgICAgICBpZiAoIWVtcHR5KCRicmFuZC0+aW1hZ2UpKXsKICAgICAgICAgICAgICAgIGlmIChmaWxlX2V4aXN0cyhwdWJsaWNfcGF0aCgkYnJhbmQtPmltYWdlKSkpewogICAgICAgICAgICAgICAgICAgIHVubGluayhwdWJsaWNfcGF0aCgkYnJhbmQtPmltYWdlKSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgICAgJGltYWdlID0gJGlucHV0c1snaW1hZ2UnXTsKICAgICAgICAgICAgJHggPSAnYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXowMTIzNDU2Nzg5JzsKICAgICAgICAgICAgJHggPSBzdHJfc2h1ZmZsZSgkeCk7CiAgICAgICAgICAgICR4ID0gc3Vic3RyKCR4LCAwLCA2KSAuICdEQUMuJzsKICAgICAgICAgICAgJGZpbGVuYW1lID0gdGltZSgpIC4gJHggLiAkaW1hZ2UtPmdldENsaWVudE9yaWdpbmFsRXh0ZW5zaW9uKCk7CiAgICAgICAgICAgIEltYWdlOjptYWtlKCRpbWFnZS0+Z2V0UmVhbFBhdGgoKSkKICAgICAgICAgICAgICAgIC0+c2F2ZShwdWJsaWNfcGF0aCgnL3VwbG9hZC9icmFuZHMvJyAuICRmaWxlbmFtZSkpOwogICAgICAgICAgICAkcGF0aCA9ICIvdXBsb2FkL2JyYW5kcy8iIC4gJGZpbGVuYW1lOwogICAgICAgICAgICAkZGF0YVsnZmlsZV9uYW1lJ10gPSAkaW5wdXRzWydpbWFnZSddLT5nZXRDbGllbnRPcmlnaW5hbE5hbWUoKTsKICAgICAgICAgICAgJGRhdGFbJ2ltYWdlJ10gPSAkcGF0aDsKICAgICAgICAgICAgJGRhdGFbJ2NvZGUnXSA9ICRpbnB1dHNbJ2NvZGUnXTsKICAgICAgICAgICAgJGRhdGFbJ25hbWUnXSA9ICRpbnB1dHNbJ25hbWUnXTsKCiAgICAgICAgICAgICRicmFuZC0+dXBkYXRlKCRkYXRhKTsKCiAgICAgICAgICAgICRkYXRhID0gWwogICAgICAgICAgICAgICAgJ3N0YXR1cycgPT4gJ3N1Y2Nlc3MnLAogICAgICAgICAgICAgICAgJ2luZ28nID0+ICRicmFuZAogICAgICAgICAgICBdOwogICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UoKS0+anNvbigkZGF0YSk7CiAgICAgICAgfWNhdGNoIChcVGhyb3dhYmxlICR0aCl7CiAgICAgICAgICAgICRkYXRhID0gWwogICAgICAgICAgICAgICAgJ3N0YXR1cycgPT4gbnVsbCwKICAgICAgICAgICAgICAgICdpbmZvJyA9PiAkdGgtPmdldE1lc3NhZ2UoKQogICAgICAgICAgICBdOwogICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UoKS0+anNvbigkZGF0YSk7CiAgICAgICAgfQogICAgfQoKICAgIC8qKgogICAgICogUmVtb3ZlIHRoZSBzcGVjaWZpZWQgcmVzb3VyY2UgZnJvbSBzdG9yYWdlLgogICAgICoKICAgICAqIEBwYXJhbSAgaW50ICAkaWQKICAgICAqIEByZXR1cm4gXElsbHVtaW5hdGVcSHR0cFxSZXNwb25zZQogICAgICovCiAgICBwdWJsaWMgZnVuY3Rpb24gZGVzdHJveShCcmFuZCAkYnJhbmQpCiAgICB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgaWYgKCRicmFuZC0+aW1hZ2UpewogICAgICAgICAgICAgICAgaWYgKGZpbGVfZXhpc3RzKHB1YmxpY19wYXRoKCRicmFuZC0+aW1hZ2UpKSl7CiAgICAgICAgICAgICAgICAgICAgdW5saW5rKHB1YmxpY19wYXRoKCRicmFuZC0+aW1hZ2UpKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICAkYnJhbmQtPmRlbGV0ZSgpOwogICAgICAgIH1jYXRjaCAoXFRocm93YWJsZSAkdGgpewogICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UoKS0+anNvbigkdGgtPmdldE1lc3NhZ2UoKSk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBpbXBvcnRCcmFuZChSZXF1ZXN0ICRyZXF1ZXN0KQogICAgewogICAgICAgICR0aGlzLT52YWxpZGF0ZSgkcmVxdWVzdCwgWwogICAgICAgICAgICAnYnJhbmRfZmlsZScgID0+ICdyZXF1aXJlZHxtaW1lczp4bHMseGxzeCcKICAgICAgICBdKTsKCiAgICAgICAgJHBhdGggPSAkcmVxdWVzdC0+ZmlsZSgnYnJhbmRfZmlsZScpLT5nZXRSZWFsUGF0aCgpOwoKICAgICAgICB0cnkgewoKICAgICAgICAgICAgRXhjZWw6OmltcG9ydChuZXcgQnJhbmRzSW1wb3J0LCAkcGF0aCk7CgogICAgICAgICAgICByZXR1cm4gJHRoaXMtPmJhY2tXaXRoU3VjY2VzcygnRXhjZWwgRGF0YSBJbXBvcnRlZCBzdWNjZXNzZnVsbHkuJyk7CgogICAgICAgIH1jYXRjaCAoXE1hYXR3ZWJzaXRlXEV4Y2VsXFZhbGlkYXRvcnNcVmFsaWRhdGlvbkV4Y2VwdGlvbiAkZSkgewogICAgICAgICAgICAkZmFpbHVyZXMgPSAkZS0+ZmFpbHVyZXMoKTsKCiAgICAgICAgICAgICRlcnJvcj1bXTsKICAgICAgICAgICAgZm9yZWFjaCAoJGZhaWx1cmVzIGFzICRmYWlsdXJlKSB7CiAgICAgICAgICAgICAgICAkZmFpbHVyZS0+cm93KCk7IAogICAgICAgICAgICAgICAgJGZhaWx1cmUtPmF0dHJpYnV0ZSgpOyAKICAgICAgICAgICAgICAgICRlcnJvcltdPSRmYWlsdXJlLT5lcnJvcnMoKTsgCiAgICAgICAgICAgICAgICAkZmFpbHVyZS0+dmFsdWVzKCk7IAogICAgICAgICAgICB9CgogICAgICAgICAgICByZXR1cm4gJHRoaXMtPmJhY2tXaXRoRXJyb3IoJGVycm9yWzBdWzBdKTsKICAgICAgICB9CiAgICB9Cn0K