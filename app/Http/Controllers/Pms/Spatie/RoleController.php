<?php
bolt_decrypt( __FILE__ , 'FDHXtb'); return 0;
##!!!##Cm5hbWVzcGFjZSBBcHBcSHR0cFxDb250cm9sbGVyc1xQbXNcU3BhdGllOwoKdXNlIElsbHVtaW5hdGVcSHR0cFxSZXF1ZXN0Owp1c2UgQXBwXEh0dHBcQ29udHJvbGxlcnNcQ29udHJvbGxlcjsKdXNlIFNwYXRpZVxQZXJtaXNzaW9uXE1vZGVsc1xSb2xlOwp1c2UgU3BhdGllXFBlcm1pc3Npb25cTW9kZWxzXFBlcm1pc3Npb247CnVzZSBWYWxpZGF0b3IsREIsWWFqcmFcRGF0YVRhYmxlc1xEYXRhVGFibGVzOwoKY2xhc3MgUm9sZUNvbnRyb2xsZXIgZXh0ZW5kcyBDb250cm9sbGVyCnsKICAgIAogICAgLyoqCiAgICAgKiBEaXNwbGF5IGEgbGlzdGluZyBvZiB0aGUgcmVzb3VyY2UuCiAgICAgKgogICAgICogQHJldHVybiBcSWxsdW1pbmF0ZVxIdHRwXFJlc3BvbnNlCiAgICAgKi8KCiAgICBwdWJsaWMgZnVuY3Rpb24gaW5kZXgoUmVxdWVzdCAkcmVxdWVzdCkKICAgIHsKICAgICAgICAkdGl0bGU9J1JvbGUnOwoKICAgICAgICByZXR1cm4gdmlldygncG1zLmJhY2tlbmQucGFnZXMuc3BhdGllLnJvbGVzLmluZGV4JywgY29tcGFjdCgndGl0bGUnKSkKCiAgICAgICAgLT53aXRoKCdpJywgKCRyZXF1ZXN0LT5pbnB1dCgncGFnZScsIDEpIC0gMSkgKiA1KTsKICAgIH0KCgogICAgcHVibGljIGZ1bmN0aW9uIHJvbGVzRGF0YSgpCiAgICB7CiAgICAgICAgJGFsbERhdGE9Um9sZTo6b3JkZXJCeSgnaWQnLCdERVNDJyktPnNlbGVjdCgncm9sZXMuKicpOwoKICAgICAgICByZXR1cm4gRGF0YVRhYmxlczo6b2YoJGFsbERhdGEpCiAgICAgICAgLT5hZGRJbmRleENvbHVtbigpCiAgICAgICAgLT5hZGRDb2x1bW4oJ0RUX1Jvd0luZGV4JywnJykKICAgICAgICAtPmFkZENvbHVtbignYWN0aW9uJywnCiAgICAgICAgICAgeyEhIEZvcm06Om9wZW4oYXJyYXkoXCdyb3V0ZVwnPT4gW1wncG1zLmFjbC5yb2xlcy5kZXN0cm95XCcsJGlkXSxcJ21ldGhvZFwnPT5cJ0RFTEVURVwnLFwnY2xhc3NcJz0+XCdkZWxldGVGb3JtXCcsXCdpZFwnPT4iZGVsZXRlRm9ybSRpZCIpKSAhIX0KICAgICAgICAgICB7eyBGb3JtOjpoaWRkZW4oXCdpZFwnLCRpZCl9fQogICAgICAgICAgIDxhIGhyZWY9ImphdmFzY3JpcHQ6dm9pZCgwKSIgb25jbGljaz0icmV0dXJuIHNob3dSb2xlV2l0aFBlcm1pc3Npb24oe3skaWR9fSkiIGNsYXNzPSJidG4gYnRuLWluZm8gYnRuLXNtIj48aSBjbGFzcz0ibGEgbGEtZXllIiB0aXRsZT0iQ2xpY2sgdG8gdmlldyBkZXRhaWxzIj48L2k+IHNob3c8L2E+CiAgICAgICAgICAgPGEgaHJlZj0ie3tyb3V0ZShcJ3Btcy5hY2wucm9sZXMuZWRpdFwnLCRpZCl9fSIgY2xhc3M9ImJ0biBidG4td2FybmluZyBidG4tc20iPjxpIGNsYXNzPSJsYSBsYS1wZW5jaWwtc3F1YXJlIiB0aXRsZT0iQ2xpY2sgdG8gRWRpdCI+PC9pPiBFZGl0PC9hPgogICAgICAgICAgIDxidXR0b24gdHlwZT0iYnV0dG9uIiBvbmNsaWNrPVwncmV0dXJuIGRlbGV0ZUNvbmZpcm0oImRlbGV0ZUZvcm17eyRpZH19Iik7XCcgY2xhc3M9ImJ0biBidG4tZGFuZ2VyIGJ0bi1zbSI+CiAgICAgICAgICAgPGkgY2xhc3M9ImxhIGxhLXRyYXNoIj48L2k+IERlbGV0ZQogICAgICAgICAgIDwvYnV0dG9uPgogICAgICAgICAgIHshISBGb3JtOjpjbG9zZSgpICEhfQogICAgICAgICAgICcpCiAgICAgICAgLT5yYXdDb2x1bW5zKFsnYWN0aW9uJ10pCiAgICAgICAgLT50b0pzb24oKTsKICAgIH0KCiAgICAvKioKCiAgICAgKiBTaG93IHRoZSBmb3JtIGZvciBjcmVhdGluZyBhIG5ldyByZXNvdXJjZS4KICAgICAqCiAgICAgKiBAcmV0dXJuIFxJbGx1bWluYXRlXEh0dHBcUmVzcG9uc2UKICAgICAqLwoKICAgIHB1YmxpYyBmdW5jdGlvbiBjcmVhdGUoKQogICAgewogICAgICAgICR0aXRsZT0nUm9sZSc7CiAgICAgICAgJG1vZHVsZXMgPSBQZXJtaXNzaW9uOjp3aGVyZU5vdE51bGwoJ21vZHVsZScpLT5ncm91cEJ5KCdtb2R1bGUnKS0+b3JkZXJCeSgnbW9kdWxlJywnQVNDJyktPnBsdWNrKCdtb2R1bGUnKS0+dG9BcnJheSgpOwogICAgICAgICRwZXJtaXNzaW9ucyA9IGNvbGxlY3QoUGVybWlzc2lvbjo6d2hlcmVOdWxsKCdtb2R1bGUnKS0+b3JkZXJCeSgnaWQnLCAnREVTQycpLT5nZXQoKSktPmNodW5rKDEwKTsKICAgICAgICByZXR1cm4gdmlldygncG1zLmJhY2tlbmQucGFnZXMuc3BhdGllLnJvbGVzLmNyZWF0ZScsIGNvbXBhY3QoJ21vZHVsZXMnLCAncGVybWlzc2lvbnMnLCd0aXRsZScpKTsKICAgIH0KCiAgICAvKioKICAgICAqIFN0b3JlIGEgbmV3bHkgY3JlYXRlZCByZXNvdXJjZSBpbiBzdG9yYWdlLgogICAgICoKICAgICAqIEBwYXJhbSAgXElsbHVtaW5hdGVcSHR0cFxSZXF1ZXN0ICAkcmVxdWVzdAogICAgICogQHJldHVybiBcSWxsdW1pbmF0ZVxIdHRwXFJlc3BvbnNlCiAgICAgKi8KCiAgICBwdWJsaWMgZnVuY3Rpb24gc3RvcmUoUmVxdWVzdCAkcmVxdWVzdCkKICAgIHsKICAgICAgICAkdGhpcy0+dmFsaWRhdGUoJHJlcXVlc3QsIFsKICAgICAgICAgICAgJ25hbWUnID0+ICdyZXF1aXJlZHx1bmlxdWU6cm9sZXMsbmFtZScsCiAgICAgICAgICAgICdwZXJtaXNzaW9uJyA9PiAncmVxdWlyZWQnLAogICAgICAgIF0pOwoKICAgICAgICBEQjo6YmVnaW5UcmFuc2FjdGlvbigpOwogICAgICAgIHRyeXsKICAgICAgICAgICAgJHJvbGUgPSBSb2xlOjpjcmVhdGUoWwogICAgICAgICAgICAgICAgJ25hbWUnID0+ICRyZXF1ZXN0LT5pbnB1dCgnbmFtZScpLAogICAgICAgICAgICAgICAgJ3dvcmRfcmVzdHJpY3Rpb25zJyA9PiBqc29uX2VuY29kZShhcnJheV9tYXAoZnVuY3Rpb24oJHZhbHVlKXsKICAgICAgICAgICAgICAgICAgICByZXR1cm4gc3RydG9sb3dlcih0cmltKCR2YWx1ZSkpOwogICAgICAgICAgICAgICAgfSwgZXhwbG9kZSgnLCcsICRyZXF1ZXN0LT5pbnB1dCgnd29yZF9yZXN0cmljdGlvbnMnKSkpKQogICAgICAgICAgICBdKTsKCiAgICAgICAgICAgICRyb2xlLT5zeW5jUGVybWlzc2lvbnMoJHJlcXVlc3QtPmlucHV0KCdwZXJtaXNzaW9uJykpOwoKICAgICAgICAgICAgREI6OmNvbW1pdCgpOwogICAgICAgICAgICByZXR1cm4gJHRoaXMtPmJhY2tXaXRoU3VjY2VzcygnUm9sZSBjcmVhdGVkIHN1Y2Nlc3NmdWxseScpOwogICAgICAgIH1jYXRjaChFeGNlcHRpb24gJGUpewogICAgICAgICAgICBEQjo6cm9sbGJhY2soKTsKICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5iYWNrV2l0aEVycm9yKCRlLT5nZXRNZXNzYWdlKCkpOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIERpc3BsYXkgdGhlIHNwZWNpZmllZCByZXNvdXJjZS4KICAgICAqCiAgICAgKiBAcGFyYW0gIGludCAgJGlkCiAgICAgKiBAcmV0dXJuIFxJbGx1bWluYXRlXEh0dHBcUmVzcG9uc2UKICAgICAqLwoKICAgIHB1YmxpYyBmdW5jdGlvbiBzaG93KCRpZCkKICAgIHsKCiAgICAgICAgJHRpdGxlID0gJ1JvbGUgd2l0aCBQZXJtaXNzaW9uJzsKICAgICAgICAkcm9sZSA9IFJvbGU6OmZpbmQoJGlkKTsKCiAgICAgICAgJHJvbGVQZXJtaXNzaW9ucyA9IFBlcm1pc3Npb246OmpvaW4oInJvbGVfaGFzX3Blcm1pc3Npb25zIiwgInJvbGVfaGFzX3Blcm1pc3Npb25zLnBlcm1pc3Npb25faWQiLCAiPSIsICJwZXJtaXNzaW9ucy5pZCIpCiAgICAgICAgLT53aGVyZSgicm9sZV9oYXNfcGVybWlzc2lvbnMucm9sZV9pZCIsICRpZCktPmdldCgpOwoKICAgICAgICByZXR1cm4gdmlldygncG1zLmJhY2tlbmQucGFnZXMuc3BhdGllLnJvbGVzLnNob3cnLCBjb21wYWN0KCd0aXRsZScsJ3JvbGUnLCAncm9sZVBlcm1pc3Npb25zJykpOwogICAgfQoKCiAgICAvKioKICAgICAqIFNob3cgdGhlIGZvcm0gZm9yIGVkaXRpbmcgdGhlIHNwZWNpZmllZCByZXNvdXJjZS4KICAgICAqCiAgICAgKiBAcGFyYW0gIGludCAgJGlkCiAgICAgKiBAcmV0dXJuIFxJbGx1bWluYXRlXEh0dHBcUmVzcG9uc2UKICAgICAqLwoKICAgIHB1YmxpYyBmdW5jdGlvbiBlZGl0KCRpZCkKICAgIHsKCiAgICAgICAgJHJvbGUgPSBSb2xlOjpmaW5kKCRpZCk7CgogICAgICAgICRtb2R1bGVzID0gUGVybWlzc2lvbjo6d2hlcmVOb3ROdWxsKCdtb2R1bGUnKS0+Z3JvdXBCeSgnbW9kdWxlJyktPm9yZGVyQnkoJ21vZHVsZScsJ0FTQycpLT5wbHVjaygnbW9kdWxlJyktPnRvQXJyYXkoKTsKICAgICAgICAkcGVybWlzc2lvbnMgPSBjb2xsZWN0KFBlcm1pc3Npb246OndoZXJlTnVsbCgnbW9kdWxlJyktPm9yZGVyQnkoJ2lkJywgJ0RFU0MnKS0+Z2V0KCkpLT5jaHVuaygxMCk7CgogICAgICAgICRyb2xlUGVybWlzc2lvbnMgPSBEQjo6dGFibGUoInJvbGVfaGFzX3Blcm1pc3Npb25zIiktPndoZXJlKCJyb2xlX2hhc19wZXJtaXNzaW9ucy5yb2xlX2lkIiwgJGlkKQoKICAgICAgICAtPnBsdWNrKCdyb2xlX2hhc19wZXJtaXNzaW9ucy5wZXJtaXNzaW9uX2lkJywgJ3JvbGVfaGFzX3Blcm1pc3Npb25zLnBlcm1pc3Npb25faWQnKS0+YWxsKCk7CiAgICAgICAgJHRpdGxlPSdVcGRhdGUgUm9sZSBhbmQgUGVybWlzc2lvbic7CgogICAgICAgIHJldHVybiB2aWV3KCdwbXMuYmFja2VuZC5wYWdlcy5zcGF0aWUucm9sZXMuZWRpdCcsIGNvbXBhY3QoJ3JvbGUnLCAnbW9kdWxlcycsICdwZXJtaXNzaW9ucycsICdyb2xlUGVybWlzc2lvbnMnLCd0aXRsZScpKTsKICAgIH0KCgoKICAgIC8qKgogICAgICogVXBkYXRlIHRoZSBzcGVjaWZpZWQgcmVzb3VyY2UgaW4gc3RvcmFnZS4KICAgICAqCiAgICAgKiBAcGFyYW0gIFxJbGx1bWluYXRlXEh0dHBcUmVxdWVzdCAgJHJlcXVlc3QKICAgICAqIEBwYXJhbSAgaW50ICAkaWQKICAgICAqIEByZXR1cm4gXElsbHVtaW5hdGVcSHR0cFxSZXNwb25zZQogICAgICovCgogICAgcHVibGljIGZ1bmN0aW9uIHVwZGF0ZShSZXF1ZXN0ICRyZXF1ZXN0LCAkaWQpCiAgICB7CgogICAgICAgICR0aGlzLT52YWxpZGF0ZSgkcmVxdWVzdCwgWwogICAgICAgICAgICAnbmFtZScgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgJ3Blcm1pc3Npb24nID0+ICdyZXF1aXJlZCcsCiAgICAgICAgXSk7CgoKICAgICAgICAkcm9sZSA9IFJvbGU6OmZpbmRPckZhaWwoJGlkKTsKCiAgICAgICAgREI6OmJlZ2luVHJhbnNhY3Rpb24oKTsKICAgICAgICB0cnl7CgogICAgICAgICAgICAkcm9sZS0+bmFtZSA9ICRyZXF1ZXN0LT5pbnB1dCgnbmFtZScpOwogICAgICAgICAgICAkcm9sZS0+d29yZF9yZXN0cmljdGlvbnMgPSBqc29uX2VuY29kZShhcnJheV9tYXAoZnVuY3Rpb24oJHZhbHVlKXsKICAgICAgICAgICAgICAgIHJldHVybiBzdHJ0b2xvd2VyKHRyaW0oJHZhbHVlKSk7CiAgICAgICAgICAgIH0sIGV4cGxvZGUoJywnLCAkcmVxdWVzdC0+aW5wdXQoJ3dvcmRfcmVzdHJpY3Rpb25zJykpKSk7CiAgICAgICAgICAgICRyb2xlLT5zYXZlKCk7CgogICAgICAgICAgICAkcm9sZS0+c3luY1Blcm1pc3Npb25zKCRyZXF1ZXN0LT5pbnB1dCgncGVybWlzc2lvbicpKTsKCiAgICAgICAgICAgIERCOjpjb21taXQoKTsKICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5iYWNrV2l0aFN1Y2Nlc3MoJ1JvbGUgYW5kIFBlcm1pc3Npb24gVXBkYXRlIHN1Y2Nlc3NmdWxseScpOwogICAgICAgIH1jYXRjaChcRXhjZXB0aW9uICRlKXsKICAgICAgICAgICAgREI6OnJvbGxiYWNrKCk7CiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+YmFja1dpdGhFcnJvcigkZS0+Z2V0TWVzc2FnZSgpKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBSZW1vdmUgdGhlIHNwZWNpZmllZCByZXNvdXJjZSBmcm9tIHN0b3JhZ2UuCiAgICAgKgogICAgICogQHBhcmFtICBpbnQgICRpZAogICAgICogQHJldHVybiBcSWxsdW1pbmF0ZVxIdHRwXFJlc3BvbnNlCiAgICAgKi8KCiAgICBwdWJsaWMgZnVuY3Rpb24gZGVzdHJveSgkaWQpCiAgICB7CiAgICAgICAgdHJ5ewogICAgICAgICAgICAkcmVzdWx0ID0gUm9sZTo6ZmluZCgkaWQpOwoKICAgICAgICAgICAgaWYoJHJlc3VsdCA9PSBOVUxMKSAvL2NoZWNrIGlmIG5vIHJlY29yZCBmb3VuZAogICAgICAgICAgICB7CiAgICAgICAgICAgICAgICByZXR1cm4gcmVkaXJlY3QoKS0+YmFjaygpLT53aXRoKCdlcnJvcicsJ1NvbWV0aGluZyBFcnJvciBGb3VuZCAhLCBQbGVhc2UgdHJ5IGFnYWluLicpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBpZigkcmVzdWx0LT5uYW1lID09J2RldmVsb3BlcicpIC8vIGZvciBhZG1pbiBhbmQgZGV2ZWxvcGVyIGFjY291bnQKICAgICAgICAgICAgewogICAgICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5iYWNrV2l0aEVycm9yKCdUaGlzIFJvbGUgQ2FuIG5vdCBiZSBkZWxldGUnKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgREI6OnRhYmxlKCJyb2xlcyIpLT53aGVyZSgnaWQnLCAkaWQpLT5kZWxldGUoKTsKICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5iYWNrV2l0aFN1Y2Nlc3MoJ1Blcm1pc3Npb24gY3JlYXRlZCBzdWNjZXNzZnVsbHknKTsKICAgICAgICB9Y2F0Y2goXEV4Y2VwdGlvbiAkZSl7CgogICAgICAgICAgICByZXR1cm4gJHRoaXMtPmJhY2tXaXRoRXJyb3IoJGUtPmdldE1lc3NhZ2UoKSk7CiAgICAgICAgfQoKICAgIH0KfQo=