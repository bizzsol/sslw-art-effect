<?php
bolt_decrypt( __FILE__ , '6xaO2p'); return 0;
##!!!##CgpuYW1lc3BhY2UgQXBwXEh0dHBcQ29udHJvbGxlcnNcUG1zOwoKdXNlIEFwcFxIdHRwXENvbnRyb2xsZXJzXENvbnRyb2xsZXI7CnVzZSBDYWNoZSwgREI7CnVzZSBDYXJib25cQ2FyYm9uOwp1c2UgSWxsdW1pbmF0ZVxEYXRhYmFzZVxFbG9xdWVudFxCdWlsZGVyOwp1c2UgSWxsdW1pbmF0ZVxIdHRwXFJlcXVlc3Q7CnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcQ29tcGFueTsKdXNlIEFwcFxNb2RlbHNcUG1zTW9kZWxzXFJlcXVpc2l0aW9uOwp1c2UgQXBwXE1vZGVsc1xQbXNNb2RlbHNcTm90aWZpY2F0aW9uOwp1c2UgQXBwXE1vZGVsc1xQbXNNb2RlbHNcUmVxdWlzaXRpb25EZWxpdmVyeUl0ZW07CnVzZSBBcHBcTW9kZWxzXFBtc01vZGVsc1xHcm5cR29vZHNSZWNlaXZlZEl0ZW1TdG9ja0luOwp1c2UgQXBwXE1vZGVsc1xQbXNNb2RlbHNcUHVyY2hhc2VcUHVyY2hhc2VPcmRlcjsKdXNlIEFwcFxNb2RlbHNcUG1zTW9kZWxzXFJmcFxSZXF1ZXN0UHJvcG9zYWw7CnVzZSBBcHBcTW9kZWxzXFBtc01vZGVsc1xRdW90YXRpb25zOwp1c2UgQXBwXE1vZGVsc1xQbXNNb2RlbHNcUXVvdGF0aW9uc0l0ZW1zOwp1c2UgQXBwXE1vZGVsc1xVc2VyQ29sdW1uVmlzaWJpbGl0eTsKdXNlIEFwcFxNb2RlbHNcU3lzdGVtSW5mb3JtYXRpb247CnVzZSBBcHBcTW9kdWxlOwp1c2UgQXBwXE1vZGVsc1xIclxVbml0Owp1c2UgQXV0aCwgRGF0YVRhYmxlczsKCmNsYXNzIFNCVUNvbnRyb2xsZXIgZXh0ZW5kcyBDb250cm9sbGVyCnsgIAogICAgcHVibGljIGZ1bmN0aW9uIGhlYWRlckNvbHVtbnMoKQogICAgewogICAgICAgIHJldHVybiAgYXJyYXkoCiAgICAgICAgICAgIFsnU0wnLCAnU0wnLCAndGV4dC1jZW50ZXInXSwKICAgICAgICAgICAgWydjb21wYW55JywgJ2NvbXBhbnknLCAndGV4dC1jZW50ZXInXSwKICAgICAgICAgICAgWydTQlVfY29kZScsICdTQlVfY29kZScsICd0ZXh0LWNlbnRlciddLAogICAgICAgICAgICBbJ1NCVV9uYW1lJywgJ1NCVV9uYW1lJywgJ3RleHQtY2VudGVyJ10sCiAgICAgICAgICAgIFsnU0JVX3Nob3J0X25hbWUnLCAnU0JVX3Nob3J0X25hbWUnLCAndGV4dC1jZW50ZXInXSwKICAgICAgICAgICAgWydTQlVfYWRkcmVzcycsICdTQlVfYWRkcmVzcycsICd0ZXh0LWNlbnRlciddLAogICAgICAgICAgICBbJ1NCVV90ZWxlcGhvbmUnLCAnU0JVX3RlbGVwaG9uZScsICd0ZXh0LWNlbnRlciddLAogICAgICAgICAgICBbJ3BhZCcsICdwYWQnLCAndGV4dC1jZW50ZXInXSwKICAgICAgICAgICAgWydhY3Rpb25zJywgJ2FjdGlvbnMnLCAndGV4dC1jZW50ZXInXSwKICAgICAgICApOwogICAgfQogICAgCiAgICBwdWJsaWMgZnVuY3Rpb24gaW5kZXgoUmVxdWVzdCAkcmVxdWVzdCkKICAgIHsKICAgICAgICBpZihyZXF1ZXN0KCktPmhhcygndXBkYXRlLXBhZCcpKXsKICAgICAgICAgICAgJHVuaXRzID0gVW5pdDo6d2hlcmVOdWxsKCdwYWQnKS0+Z2V0KCk7CiAgICAgICAgICAgIGlmKGlzc2V0KCR1bml0c1swXSkpewogICAgICAgICAgICAgICAgZm9yZWFjaCgkdW5pdHMgYXMgJHVuaXQpewogICAgICAgICAgICAgICAgICAgICR1bml0LT5wYWQgPSAnYXNzZXRzL2lkY2FyZC9sZXR0ZXJoZWFkLycuJHVuaXQtPmhyX3VuaXRfc2hvcnRfbmFtZS4nLnBuZyc7CiAgICAgICAgICAgICAgICAgICAgJHVuaXQtPnNhdmUoKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICByZXR1cm4gJ29rJzsKICAgICAgICB9CgogICAgICAgIHRyeSB7CiAgICAgICAgICAgIGlmIChyZXF1ZXN0KCktPmFqYXgoKSkgewogICAgICAgICAgICAgICAgcmV0dXJuIERhdGF0YWJsZXM6Om9mKAogICAgICAgICAgICAgICAgICAgICAgICBVbml0Ojp3aXRoKFsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICdjb21wYW55JwogICAgICAgICAgICAgICAgICAgICAgICBdKQogICAgICAgICAgICAgICAgICAgICkKICAgICAgICAgICAgICAgICAgICAtPmFkZEluZGV4Q29sdW1uKCkKCiAgICAgICAgICAgICAgICAgICAgLT5hZGRDb2x1bW4oJ2NvbXBhbnknLCBmdW5jdGlvbigkdW5pdCl7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAnWycuJHVuaXQtPmNvbXBhbnktPmNvZGUuJ10gJy4kdW5pdC0+Y29tcGFueS0+bmFtZTsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+ZmlsdGVyQ29sdW1uKCdjb21wYW55JywgZnVuY3Rpb24gKCRxdWVyeSwgJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmVIYXMoJ2NvbXBhbnknLCBmdW5jdGlvbiAoJHF1ZXJ5KSB1c2UoJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICRxdWVyeS0+d2hlcmUoJ2NvZGUnLCAnTElLRScsICclJy4ka2V5d29yZC4nJScpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtPm9yV2hlcmUoJ25hbWUnLCAnTElLRScsICclJy4ka2V5d29yZC4nJScpOwogICAgICAgICAgICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+b3JkZXJDb2x1bW4oJ2NvbXBhbnknLCBmdW5jdGlvbiAoJHF1ZXJ5LCAkb3JkZXIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHBsZWFzZVNvcnRNZSgkcXVlcnksICRvcmRlciwgQ29tYXBueTo6c2VsZWN0KCdjb21wYW5pZXMuY29kZScpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAtPndoZXJlQ29sdW1uKCdjb21wYW5pZXMuaWQnLCAnaHJfdW5pdC5jb21wYW55X2lkJykKICAgICAgICAgICAgICAgICAgICAgICAgICAgIC0+dGFrZSgxKQogICAgICAgICAgICAgICAgICAgICAgICApOwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgLT5hZGRDb2x1bW4oJ1NCVV9jb2RlJywgZnVuY3Rpb24oJHVuaXQpewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHVuaXQtPmhyX3VuaXRfY29kZTsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+ZmlsdGVyQ29sdW1uKCdTQlVfY29kZScsIGZ1bmN0aW9uICgkcXVlcnksICRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlKCdocl91bml0X2NvZGUnLCAnTElLRScsICclJy4ka2V5d29yZC4nJScpOwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgLT5vcmRlckNvbHVtbignU0JVX2NvZGUnLCBmdW5jdGlvbiAoJHF1ZXJ5LCAkb3JkZXIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+b3JkZXJieSgnaHJfdW5pdF9jb2RlJywgJG9yZGVyKTsKICAgICAgICAgICAgICAgICAgICB9KQoKICAgICAgICAgICAgICAgICAgICAtPmFkZENvbHVtbignU0JVX25hbWUnLCBmdW5jdGlvbigkdW5pdCl7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkdW5pdC0+aHJfdW5pdF9uYW1lOwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgLT5maWx0ZXJDb2x1bW4oJ1NCVV9uYW1lJywgZnVuY3Rpb24gKCRxdWVyeSwgJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ2hyX3VuaXRfbmFtZScsICdMSUtFJywgJyUnLiRrZXl3b3JkLiclJyk7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAtPm9yZGVyQ29sdW1uKCdTQlVfbmFtZScsIGZ1bmN0aW9uICgkcXVlcnksICRvcmRlcikgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT5vcmRlcmJ5KCdocl91bml0X25hbWUnLCAkb3JkZXIpOwogICAgICAgICAgICAgICAgICAgIH0pCgogICAgICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdTQlVfc2hvcnRfbmFtZScsIGZ1bmN0aW9uKCR1bml0KXsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICR1bml0LT5ocl91bml0X3Nob3J0X25hbWU7CiAgICAgICAgICAgICAgICAgICAgfSkKICAgICAgICAgICAgICAgICAgICAtPmZpbHRlckNvbHVtbignU0JVX3Nob3J0X25hbWUnLCBmdW5jdGlvbiAoJHF1ZXJ5LCAka2V5d29yZCkgewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZSgnaHJfdW5pdF9zaG9ydF9uYW1lJywgJ0xJS0UnLCAnJScuJGtleXdvcmQuJyUnKTsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+b3JkZXJDb2x1bW4oJ1NCVV9zaG9ydF9uYW1lJywgZnVuY3Rpb24gKCRxdWVyeSwgJG9yZGVyKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPm9yZGVyYnkoJ2hyX3VuaXRfc2hvcnRfbmFtZScsICRvcmRlcik7CiAgICAgICAgICAgICAgICAgICAgfSkKCiAgICAgICAgICAgICAgICAgICAgLT5hZGRDb2x1bW4oJ1NCVV9hZGRyZXNzJywgZnVuY3Rpb24oJHVuaXQpewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJHVuaXQtPmhyX3VuaXRfYWRkcmVzczsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+ZmlsdGVyQ29sdW1uKCdTQlVfYWRkcmVzcycsIGZ1bmN0aW9uICgkcXVlcnksICRrZXl3b3JkKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlKCdocl91bml0X2FkZHJlc3MnLCAnTElLRScsICclJy4ka2V5d29yZC4nJScpOwogICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgLT5vcmRlckNvbHVtbignU0JVX2FkZHJlc3MnLCBmdW5jdGlvbiAoJHF1ZXJ5LCAkb3JkZXIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+b3JkZXJieSgnaHJfdW5pdF9hZGRyZXNzJywgJG9yZGVyKTsKICAgICAgICAgICAgICAgICAgICB9KQoKICAgICAgICAgICAgICAgICAgICAtPmFkZENvbHVtbignU0JVX3RlbGVwaG9uZScsIGZ1bmN0aW9uKCR1bml0KXsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICR1bml0LT5ocl91bml0X3RlbGVwaG9uZTsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+ZmlsdGVyQ29sdW1uKCdTQlVfdGVsZXBob25lJywgZnVuY3Rpb24gKCRxdWVyeSwgJGtleXdvcmQpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ2hyX3VuaXRfdGVsZXBob25lJywgJ0xJS0UnLCAnJScuJGtleXdvcmQuJyUnKTsKICAgICAgICAgICAgICAgICAgICB9KQogICAgICAgICAgICAgICAgICAgIC0+b3JkZXJDb2x1bW4oJ1NCVV90ZWxlcGhvbmUnLCBmdW5jdGlvbiAoJHF1ZXJ5LCAkb3JkZXIpIHsKICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+b3JkZXJieSgnaHJfdW5pdF90ZWxlcGhvbmUnLCAkb3JkZXIpOwogICAgICAgICAgICAgICAgICAgIH0pCgogICAgICAgICAgICAgICAgICAgIC0+ZWRpdENvbHVtbigncGFkJywgZnVuY3Rpb24oJHVuaXQpewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gIWVtcHR5KCR1bml0LT5wYWQpID8gJzxhIGhyZWY9IicudXJsKCR1bml0LT5wYWQpLiciIHRhcmdldD0iX2JsYW5rIj48aW1nIHNyYz0iJy51cmwoJHVuaXQtPnBhZCkuJyIgc3R5bGU9ImhlaWdodDogMTAwcHgiLz48L2E+JyA6ICcnOwogICAgICAgICAgICAgICAgICAgIH0pCgogICAgICAgICAgICAgICAgICAgIC0+YWRkQ29sdW1uKCdhY3Rpb25zJywgZnVuY3Rpb24oJHVuaXQpewogICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gJzxhIGhyZWY9IicudXJsKCdwbXMvc2J1LycuJHVuaXQtPmhyX3VuaXRfaWQuJy9lZGl0JykuJyIgY2xhc3M9ImJ0biBidG4taW5mbyBidG4teHMiPjxpIGNsYXNzPSJsYSBsYS1lZGl0Ij48L2k+PC9hPjxhIGNsYXNzPSJidG4gYnRuLXhzIGJ0bi1kYW5nZXIgbWwtMiIgb25jbGljaz0iZGVsZXRlRnJvbUNSVUQoJCh0aGlzKSkiIGRhdGEtc3JjPSInLnJvdXRlKCdwbXMuc2J1LmRlc3Ryb3knLCAkdW5pdC0+aHJfdW5pdF9pZCkuJyI+PGkgY2xhc3M9ImxhIGxhLXRyYXNoIj48L2k+PC9hPic7CiAgICAgICAgICAgICAgICAgICAgfSkKCiAgICAgICAgICAgICAgICAgICAgLT5yYXdDb2x1bW5zKFsnYWN0aW9ucycsICdwYWQnXSkKICAgICAgICAgICAgICAgICAgICAtPm1ha2UodHJ1ZSk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiB2aWV3KCdwbXMuYmFja2VuZC5wYWdlcy5zYnUuaW5kZXgnLCBbCiAgICAgICAgICAgICAgICAndGl0bGUnID0+ICdTQlUnLAogICAgICAgICAgICAgICAgJ2hlYWRlckNvbHVtbnMnID0+ICR0aGlzLT5oZWFkZXJDb2x1bW5zKCkKICAgICAgICAgICAgXSk7CiAgICAgICAgfWNhdGNoIChcVGhyb3dhYmxlICR0aCl7CiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+YmFja1dpdGhFcnJvcigkdGgtPmdldE1lc3NhZ2UoKSk7CiAgICAgICAgfQogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBjcmVhdGUoUmVxdWVzdCAkcmVxdWVzdCkKICAgIHsKICAgICAgICByZXR1cm4gdmlldygncG1zLmJhY2tlbmQucGFnZXMuc2J1LmNyZWF0ZScsIFsKICAgICAgICAgICAgJ3RpdGxlJyA9PiAiQ3JlYXRlIE1vZHVsZSIsCiAgICAgICAgICAgICdjb21wYW5pZXMnID0+IENvbXBhbnk6OmFsbCgpLAogICAgICAgIF0pOwogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiBzdG9yZShSZXF1ZXN0ICRyZXF1ZXN0KQogICAgewogICAgICAgICR0aGlzLT52YWxpZGF0ZSgkcmVxdWVzdCwgWwogICAgICAgICAgICAnY29tcGFueV9pZCcgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgJ2hyX3VuaXRfY29kZScgPT4gJ3JlcXVpcmVkfHVuaXF1ZTpocl91bml0JywKICAgICAgICAgICAgJ2hyX3VuaXRfc2hvcnRfbmFtZScgPT4gJ3JlcXVpcmVkfHVuaXF1ZTpocl91bml0JywKICAgICAgICAgICAgJ2hyX3VuaXRfbmFtZScgPT4gJ3JlcXVpcmVkfHVuaXF1ZTpocl91bml0JywKICAgICAgICAgICAgJ2hyX3VuaXRfYWRkcmVzcycgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgJ2hyX3VuaXRfdGVsZXBob25lJyA9PiAncmVxdWlyZWQnLAogICAgICAgIF0pOwoKICAgICAgICBEQjo6YmVnaW5UcmFuc2FjdGlvbigpOwogICAgICAgIHRyeXsKICAgICAgICAgICAgJHVuaXQgPSBuZXcgVW5pdCgpOwogICAgICAgICAgICAkdW5pdC0+ZmlsbCgkcmVxdWVzdC0+YWxsKCkpOwogICAgICAgICAgICAkdW5pdC0+aHJfdW5pdF9uYW1lX2JuID0gJHJlcXVlc3QtPmhyX3VuaXRfbmFtZTsKICAgICAgICAgICAgJHVuaXQtPmhyX3VuaXRfYWRkcmVzc19ibiA9ICRyZXF1ZXN0LT5ocl91bml0X2FkZHJlc3M7CiAgICAgICAgICAgICR1bml0LT5zYXZlKCk7CgogICAgICAgICAgICBEQjo6Y29tbWl0KCk7CiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+YmFja1dpdGhTdWNjZXNzKCdTQlUgQ3JlYXRlZCBzdWNjZXNzZnVsbHknKTsKICAgICAgICB9Y2F0Y2ggKFxFeGNlcHRpb24gJGUpewogICAgICAgICAgICBEQjo6cm9sbGJhY2soKTsKICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5iYWNrV2l0aEVycm9yKCRlLT5nZXRNZXNzYWdlKCkpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gZWRpdCgkaWQpCiAgICB7CiAgICAgICAgcmV0dXJuIHZpZXcoJ3Btcy5iYWNrZW5kLnBhZ2VzLnNidS5lZGl0JywgWwogICAgICAgICAgICAndGl0bGUnID0+ICJFZGl0IFNCVSIsCiAgICAgICAgICAgICd1bml0JyA9PiBVbml0OjpmaW5kT3JGYWlsKCRpZCksCiAgICAgICAgICAgICdjb21wYW5pZXMnID0+IENvbXBhbnk6OmFsbCgpLAogICAgICAgIF0pOwogICAgfQoKICAgIHB1YmxpYyBmdW5jdGlvbiB1cGRhdGUoUmVxdWVzdCAkcmVxdWVzdCwgJGlkKQogICAgewogICAgICAgICR0aGlzLT52YWxpZGF0ZSgkcmVxdWVzdCwgWwogICAgICAgICAgICAnY29tcGFueV9pZCcgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgJ2hyX3VuaXRfY29kZScgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgJ2hyX3VuaXRfc2hvcnRfbmFtZScgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgJ2hyX3VuaXRfbmFtZScgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgJ2hyX3VuaXRfYWRkcmVzcycgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgJ2hyX3VuaXRfdGVsZXBob25lJyA9PiAncmVxdWlyZWQnLAogICAgICAgIF0pOwoKICAgICAgICBpZigkcmVxdWVzdC0+aGFzRmlsZSgncGFkX2ZpbGUnKSl7CiAgICAgICAgICAgICR0aGlzLT52YWxpZGF0ZSgkcmVxdWVzdCwgWwogICAgICAgICAgICAgICAgJ3BhZF9maWxlJyA9PiAncmVxdWlyZWR8aW1hZ2V8bWF4OjEwMjQwJywKICAgICAgICAgICAgXSk7CiAgICAgICAgfQoKICAgICAgICBEQjo6YmVnaW5UcmFuc2FjdGlvbigpOwogICAgICAgIHRyeXsKICAgICAgICAgICAgJHNlYXJjaCA9IFVuaXQ6OndoZXJlKGZ1bmN0aW9uKCRxdWVyeSkgdXNlKCRyZXF1ZXN0KXsKICAgICAgICAgICAgICAgIHJldHVybiAkcXVlcnktPndoZXJlKCdjb21wYW55X2lkJywgJHJlcXVlc3QtPmNvbXBhbnlfaWQpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLT53aGVyZSgnaHJfdW5pdF9jb2RlJywgJHJlcXVlc3QtPmhyX3VuaXRfY29kZSkKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAtPm9yV2hlcmUoJ2hyX3VuaXRfc2hvcnRfbmFtZScsICRyZXF1ZXN0LT5ocl91bml0X3Nob3J0X25hbWUpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLT5vcldoZXJlKCdocl91bml0X25hbWUnLCAkcmVxdWVzdC0+aHJfdW5pdF9uYW1lKTsKICAgICAgICAgICAgfSkKICAgICAgICAgICAgLT53aGVyZSgnaHJfdW5pdF9pZCcsICchPScsICRpZCkKICAgICAgICAgICAgLT5maXJzdCgpOwogICAgICAgICAgICBpZihpc3NldCgkc2VhcmNoLT5ocl91bml0X2lkKSl7CiAgICAgICAgICAgICAgICByZXR1cm4gJHRoaXMtPmJhY2tXaXRoRXJyb3IoIlNCVSBBbHJlYWR5IEV4aXN0cy4iKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgJHVuaXQgPSBVbml0OjpmaW5kKCRpZCk7CiAgICAgICAgICAgICR1bml0LT5maWxsKCRyZXF1ZXN0LT5hbGwoKSk7CiAgICAgICAgICAgICR1bml0LT5ocl91bml0X25hbWVfYm4gPSAkcmVxdWVzdC0+aHJfdW5pdF9uYW1lOwogICAgICAgICAgICAkdW5pdC0+aHJfdW5pdF9hZGRyZXNzX2JuID0gJHJlcXVlc3QtPmhyX3VuaXRfYWRkcmVzczsKICAgICAgICAgICAgJHVuaXQtPnNhdmUoKTsKCiAgICAgICAgICAgIGlmKCRyZXF1ZXN0LT5oYXNGaWxlKCdwYWRfZmlsZScpKXsKICAgICAgICAgICAgICAgIGlmKCFlbXB0eSgkdW5pdC0+cGFkKSl7CiAgICAgICAgICAgICAgICAgICAgJHRoaXMtPmZpbGVEZWxldGUoJHVuaXQtPnBhZCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICR1bml0LT5wYWQgPSAkdGhpcy0+ZmlsZVVwbG9hZCgkcmVxdWVzdC0+ZmlsZSgncGFkX2ZpbGUnKSwgJ3VwbG9hZC9wYWRzJyk7CiAgICAgICAgICAgICAgICAkdW5pdC0+c2F2ZSgpOwogICAgICAgICAgICB9CgogICAgICAgICAgICBEQjo6Y29tbWl0KCk7CiAgICAgICAgICAgIHJldHVybiAkdGhpcy0+YmFja1dpdGhTdWNjZXNzKCdTQlUgVXBkYXRlZCBzdWNjZXNzZnVsbHknKTsKICAgICAgICB9Y2F0Y2ggKFxFeGNlcHRpb24gJGUpewogICAgICAgICAgICBEQjo6cm9sbGJhY2soKTsKICAgICAgICAgICAgcmV0dXJuICR0aGlzLT5iYWNrV2l0aEVycm9yKCRlLT5nZXRNZXNzYWdlKCkpOwogICAgICAgIH0KICAgIH0KCiAgICBwdWJsaWMgZnVuY3Rpb24gZGVzdHJveSgkaWQpCiAgICB7CiAgICAgICAgdHJ5IHsKICAgICAgICAgICAgVW5pdDo6d2hlcmUoJ2hyX3VuaXRfaWQnLCAkaWQpLT5kZWxldGUoKTsKICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlKCktPmpzb24oWwogICAgICAgICAgICAgICAgJ3N1Y2Nlc3MnID0+IHRydWUKICAgICAgICAgICAgXSk7CiAgICAgICAgfWNhdGNoIChcVGhyb3dhYmxlICR0aCl7CiAgICAgICAgICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKFsKICAgICAgICAgICAgICAgICdzdWNjZXNzJyA9PiB0cnVlLAogICAgICAgICAgICAgICAgJ21lc3NhZ2UnID0+ICR0aC0+Z2V0TWVzc2FnZSgpCiAgICAgICAgICAgIF0pOwogICAgICAgIH0KICAgIH0KfQo=