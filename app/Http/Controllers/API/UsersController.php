<?php
bolt_decrypt( __FILE__ , '0mDRwV'); return 0;
##!!!##CgpuYW1lc3BhY2UgQXBwXEh0dHBcQ29udHJvbGxlcnNcQVBJOwoKdXNlIEFwcFxIdHRwXENvbnRyb2xsZXJzXENvbnRyb2xsZXI7CnVzZSBJbGx1bWluYXRlXEh0dHBcUmVxdWVzdDsKdXNlIFxBcHBcVXNlcjsKdXNlIFxBcHBcTW9kZWxzXEhyXFNlY3Rpb247CnVzZSBcQXBwXE1vZGVsc1xQbXNNb2RlbHNcQWNjb3VudHNcQ29zdENlbnRyZTsKdXNlIERCOwoKY2xhc3MgVXNlcnNDb250cm9sbGVyIGV4dGVuZHMgQ29udHJvbGxlcgp7CiAgICAvKioKICAgICAqIExpc3Qgb2YgVXNlcnMKICAgICAqIAogICAgICogR2V0IHRoZSBMaXN0IG9mIGFsbCBhdmFpbGFibGUgVXNlcnMuCiAgICAgKiAKICAgICAqIEBxdWVyeVBhcmFtIHRva2VuIHN0cmluZyByZXF1aXJlZCBBdXRoZW50aWNhdGlvbiBUb2tlbiBMaXN0IHdvdWxkIGJlIHByb3ZpZGVkIGJ5IEJJWlpTT0wgRXhhbXBsZTogYWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXphYmNkZWYKICAgICAqIAogICAgICogQGdyb3VwIFVzZXIKICAgICAqIEByZXR1cm4gXElsbHVtaW5hdGVcSHR0cFxSZXNwb25zZQogICAgICovCiAgICBwdWJsaWMgZnVuY3Rpb24gaW5kZXgoUmVxdWVzdCAkcmVxdWVzdCl7CiAgICAgICAgdHJ5ewogICAgICAgICAgICAkZGF0YSA9IFVzZXI6OndpdGgoWwogICAgICAgICAgICAgICAgJ2VtcGxveWVlLmRlc2lnbmF0aW9uJywKICAgICAgICAgICAgICAgICdwcmlvcml0aWVzLnVuaXQnLAogICAgICAgICAgICAgICAgJ3ByaW9yaXRpZXMuZGVwYXJ0bWVudCcsCiAgICAgICAgICAgICAgICAncHJpb3JpdGllcy5zZWN0aW9uJywKICAgICAgICAgICAgICAgICdjb21wYW5pZXMuY29tcGFueScsCiAgICAgICAgICAgICAgICAnY29zdENlbnRyZXMuY29zdENlbnRyZScKICAgICAgICAgICAgXSkKICAgICAgICAgICAgLT53aGVuKCRyZXF1ZXN0LT5nZXQoJ3VpZCcpID4gMCwgZnVuY3Rpb24oJHF1ZXJ5KSB1c2UoJHJlcXVlc3QpewogICAgICAgICAgICAgICAgcmV0dXJuICRxdWVyeS0+d2hlcmUoJ2Fzc29jaWF0ZV9pZCcsICRyZXF1ZXN0LT5nZXQoJ3VpZCcpKTsKICAgICAgICAgICAgfSkKICAgICAgICAgICAgLT53aGVuKCRyZXF1ZXN0LT5nZXQoJ2VtYWlsJykgPiAwLCBmdW5jdGlvbigkcXVlcnkpIHVzZSgkcmVxdWVzdCl7CiAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZSgnZW1haWwnLCAkcmVxdWVzdC0+Z2V0KCdlbWFpbCcpKTsKICAgICAgICAgICAgfSkKICAgICAgICAgICAgLT53aGVuKCRyZXF1ZXN0LT5nZXQoJ3Bob25lJykgPiAwLCBmdW5jdGlvbigkcXVlcnkpIHVzZSgkcmVxdWVzdCl7CiAgICAgICAgICAgICAgICByZXR1cm4gJHF1ZXJ5LT53aGVyZSgncGhvbmUnLCAkcmVxdWVzdC0+Z2V0KCdwaG9uZScpKTsKICAgICAgICAgICAgfSkKICAgICAgICAgICAgLT5nZXQoKTsKICAgICAgICAgICAgJHVzZXJzID0gW107CiAgICAgICAgICAgIGlmKGlzc2V0KCRkYXRhWzBdKSl7CiAgICAgICAgICAgICAgICBmb3JlYWNoKCRkYXRhIGFzICRrZXkgPT4gJHVzZXIpewogICAgICAgICAgICAgICAgICAgIGFycmF5X3B1c2goJHVzZXJzLCBbCiAgICAgICAgICAgICAgICAgICAgICAgICdpZCcgPT4gJHVzZXItPmlkLAogICAgICAgICAgICAgICAgICAgICAgICAndWlkJyA9PiAkdXNlci0+YXNzb2NpYXRlX2lkLAogICAgICAgICAgICAgICAgICAgICAgICAnbmFtZScgPT4gJHVzZXItPm5hbWUsCiAgICAgICAgICAgICAgICAgICAgICAgICdkZXNpZ25hdGlvbicgPT4gaXNzZXQoJHVzZXItPmVtcGxveWVlLT5kZXNpZ25hdGlvbi0+aHJfZGVzaWduYXRpb25fbmFtZSkgPyAkdXNlci0+ZW1wbG95ZWUtPmRlc2lnbmF0aW9uLT5ocl9kZXNpZ25hdGlvbl9uYW1lIDogJycsCiAgICAgICAgICAgICAgICAgICAgICAgICdlbWFpbCcgPT4gJHVzZXItPmVtYWlsLAogICAgICAgICAgICAgICAgICAgICAgICAncGhvbmUnID0+ICR1c2VyLT5waG9uZSwKICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICd1bml0cycgPT4gJHVzZXItPnByaW9yaXRpZXMtPnBsdWNrKCd1bml0LmhyX3VuaXRfbmFtZScsICd1bml0LmhyX3VuaXRfaWQnKS0+dG9BcnJheSgpLAogICAgICAgICAgICAgICAgICAgICAgICAnZGVwYXJ0bWVudHMnID0+ICR1c2VyLT5wcmlvcml0aWVzLT5wbHVjaygnZGVwYXJ0bWVudC5ocl9kZXBhcnRtZW50X25hbWUnLCAnZGVwYXJ0bWVudC5ocl9kZXBhcnRtZW50X2lkJyktPnRvQXJyYXkoKSwKICAgICAgICAgICAgICAgICAgICAgICAgJ3NlY3Rpb25zJyA9PiAkdXNlci0+cHJpb3JpdGllcy0+cGx1Y2soJ3NlY3Rpb24uaHJfc2VjdGlvbl9uYW1lJywgJ3NlY3Rpb24uaHJfc2VjdGlvbl9pZCcpLT50b0FycmF5KCksCgogICAgICAgICAgICAgICAgICAgICAgICAnY29tcGFuaWVzJyA9PiAkdXNlci0+Y29tcGFuaWVzLT5wbHVjaygnY29tcGFueS5uYW1lJyktPmltcGxvZGUoJywgJyksCiAgICAgICAgICAgICAgICAgICAgICAgICdjb3N0Q2VudHJlcycgPT4gJHVzZXItPmNvc3RDZW50cmVzLT5wbHVjaygnY29zdENlbnRyZS5uYW1lJyktPmltcGxvZGUoJywgJyksCgogICAgICAgICAgICAgICAgICAgICAgICAncm9sZXMnID0+ICR1c2VyLT5yb2xlcy0+cGx1Y2soJ25hbWUnKS0+dG9BcnJheSgpCiAgICAgICAgICAgICAgICAgICAgXSk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKFsKICAgICAgICAgICAgICAgICdzdWNjZXNzJyA9PiB0cnVlLAogICAgICAgICAgICAgICAgJ3N0YXR1cycgPT4gdHJ1ZSwKICAgICAgICAgICAgICAgICdzdGF0dXNfY29kZScgPT4gMjAwLAogICAgICAgICAgICAgICAgJ2RhdGEnID0+IFsKICAgICAgICAgICAgICAgICAgICAndXNlcnMnID0+ICR1c2VycywKICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgXSwgMjAwKTsKICAgICAgICB9Y2F0Y2ggKFxUaHJvd2FibGUgJHRoKXsKICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlKCktPmpzb24oWwogICAgICAgICAgICAgICAgJ3N1Y2Nlc3MnID0+IGZhbHNlLAogICAgICAgICAgICAgICAgJ3N0YXR1cycgPT4gZmFsc2UsCiAgICAgICAgICAgICAgICAnc3RhdHVzX2NvZGUnID0+IDUwMCwKICAgICAgICAgICAgICAgICdtZXNzYWdlJyA9PiAkdGgtPmdldE1lc3NhZ2UoKQogICAgICAgICAgICBdLCA1MDApOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFN0b3JlIFVzZXIKICAgICAqIAogICAgICogU3RvcmUgYSBuZXcgVXNlci4KICAgICAqIAogICAgICogQHF1ZXJ5UGFyYW0gdG9rZW4gc3RyaW5nIHJlcXVpcmVkIEF1dGhlbnRpY2F0aW9uIFRva2VuIExpc3Qgd291bGQgYmUgcHJvdmlkZWQgYnkgQklaWlNPTCBFeGFtcGxlOiBhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5emFiY2RlZgogICAgICogQGJvZHlQYXJhbSBuYW1lIHN0cmluZyByZXF1aXJlZCBOYW1lIG9mIHRoZSBVc2VyIEV4YW1wbGU6IEpvaG4gRG9lCiAgICAgKiBAYm9keVBhcmFtIHVpZCBzdHJpbmcgcmVxdWlyZWQgVUlEIG9mIHRoZSBVc2VyIEV4YW1wbGU6IDEwMDEKICAgICAqIEBib2R5UGFyYW0gZW1haWwgZW1haWwgcmVxdWlyZWQgRW1haWwgb2YgdGhlIFVzZXIgRXhhbXBsZTogZXhhbXBsZUBlbWFpbC5jb20KICAgICAqIEBib2R5UGFyYW0gcGhvbmUgc3RyaW5nIFBob25lIG9mIHRoZSBVc2VyIEV4YW1wbGU6IDAxMjM0NTY3ODkwCiAgICAgKiBAYm9keVBhcmFtIHBhc3N3b3JkIHN0cmluZyByZXF1aXJlZCBQYXNzd29yZCBvZiB0aGUgVXNlciBFeGFtcGxlOiAxMjM0NTY3OAogICAgICogQGJvZHlQYXJhbSBwYXNzd29yZF9jb25maXJtYXRpb24gc3RyaW5nIHJlcXVpcmVkIFBhc3N3b3JkIENvbmZpcm1hdGlvbiBvZiB0aGUgVXNlciBFeGFtcGxlOiAxMjM0NTY3OAogICAgICogQGJvZHlQYXJhbSBzZWN0aW9ucyBhcnJheSByZXF1aXJlZCBBcnJheSBvZiBTZWN0aW9ucyBvZiB0aGUgVXNlciBFeGFtcGxlOiBbMSwgMiwgM10KICAgICAqIEBib2R5UGFyYW0gcm9sZXMgYXJyYXkgcmVxdWlyZWQgQXJyYXkgb2YgUm9sZXMgb2YgdGhlIFVzZXIgRXhhbXBsZTogWyJBZG1pbiIsICJFbXBsb3llZSJdCiAgICAgKgogICAgICogQHJlc3BvbnNlIHsKICAgICAqICAgICAgICJzdWNjZXNzIjogdHJ1ZSwKICAgICAqICAgICAgICJzdGF0dXMiOiB0cnVlLAogICAgICogICAgICAgInN1Y2Nlc3NfY29kZSI6IDIwMCwKICAgICAqICAgICAgICJkYXRhIjogewogICAgICogICAgICAgICAgICJtZXNzYWdlIjogIlVzZXIgaGFzIGJlZW4gc3RvcmVkIHN1Y2Nlc3NmdWxseS4iCiAgICAgKiAgICAgICB9CiAgICAgKiAgIH0KICAgICAqIAogICAgICogQGdyb3VwIFVzZXIKICAgICAqIEBwYXJhbSAgXElsbHVtaW5hdGVcSHR0cFxSZXF1ZXN0ICAkcmVxdWVzdAogICAgICogQHJldHVybiBcSWxsdW1pbmF0ZVxIdHRwXFJlc3BvbnNlCiAgICAgKi8KICAgIHB1YmxpYyBmdW5jdGlvbiBzdG9yZShSZXF1ZXN0ICRyZXF1ZXN0KQogICAgewogICAgICAgICR2YWxpZGF0b3IgPSBcVmFsaWRhdG9yOjptYWtlKCRyZXF1ZXN0LT5hbGwoKSwgWwogICAgICAgICAgICAnbmFtZScgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgJ3VpZCcgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgJ2VtYWlsJyA9PiAncmVxdWlyZWQnLAogICAgICAgICAgICAncGFzc3dvcmQnID0+ICdyZXF1aXJlZHxtaW46Nnxjb25maXJtZWQnLAogICAgICAgICAgICAnc2VjdGlvbnMnID0+ICdyZXF1aXJlZCcsCiAgICAgICAgICAgICdzZWN0aW9ucy4qJyA9PiAncmVxdWlyZWQnLAogICAgICAgICAgICAncm9sZXMnID0+ICdyZXF1aXJlZCcsCiAgICAgICAgICAgICdyb2xlcy4qJyA9PiAncmVxdWlyZWQnLAogICAgICAgIF0pOwoKICAgICAgICBpZiAoJHZhbGlkYXRvci0+cGFzc2VzKCkpIHsKICAgICAgICAgICAgREI6OmJlZ2luVHJhbnNhY3Rpb24oKTsKICAgICAgICAgICAgdHJ5ewogICAgICAgICAgICAgICAgJHVzZXIgPSBVc2VyOjpjcmVhdGUoWwogICAgICAgICAgICAgICAgICAgICduYW1lJyA9PiAkcmVxdWVzdC0+bmFtZSwKICAgICAgICAgICAgICAgICAgICAnYXNzb2NpYXRlX2lkJyA9PiAkcmVxdWVzdC0+dWlkLAogICAgICAgICAgICAgICAgICAgICdlbWFpbCcgPT4gJHJlcXVlc3QtPmVtYWlsLAogICAgICAgICAgICAgICAgICAgICdwaG9uZScgPT4gJHJlcXVlc3QtPnBob25lLAogICAgICAgICAgICAgICAgICAgICdwYXNzd29yZCcgPT4gYmNyeXB0KCRyZXF1ZXN0LT5wYXNzd29yZCksCiAgICAgICAgICAgICAgICAgICAgJ2Nvc3RfY2VudHJlX2lkJyA9PiBDb3N0Q2VudHJlOjp3aGVyZU5vdE51bGwoJ2lkJyktPmZpcnN0KCktPmlkLAogICAgICAgICAgICAgICAgICAgICdjcmVhdGVkX2J5JyA9PiBhdXRoKCktPnVzZXIoKS0+aWQsCiAgICAgICAgICAgICAgICAgICAgJ3Rva2VuJyA9PiBcU3RyOjpyYW5kb20oMzIpCiAgICAgICAgICAgICAgICBdKTsKCiAgICAgICAgICAgICAgICAkcHJpb3JpdGllcyA9IFtdOwogICAgICAgICAgICAgICAgaWYoaXNzZXQoJHJlcXVlc3QtPnNlY3Rpb25zWzBdKSl7CiAgICAgICAgICAgICAgICAgICAgZm9yZWFjaCgkcmVxdWVzdC0+c2VjdGlvbnMgYXMgJGtleSA9PiAkaHJfc2VjdGlvbl9pZCl7CiAgICAgICAgICAgICAgICAgICAgICAgICRzZWN0aW9uID0gU2VjdGlvbjo6d2l0aChbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGVwYXJ0bWVudCcKICAgICAgICAgICAgICAgICAgICAgICAgXSktPmZpbmQoJGhyX3NlY3Rpb25faWQpOwogICAgICAgICAgICAgICAgICAgICAgICBhcnJheV9wdXNoKCRwcmlvcml0aWVzLCBbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAndXNlcl9pZCcgPT4gJHVzZXItPmlkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2hyX3VuaXRfaWQnID0+ICRzZWN0aW9uLT5kZXBhcnRtZW50LT5ocl91bml0X2lkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2hyX2RlcGFydG1lbnRfaWQnID0+ICRzZWN0aW9uLT5ocl9zZWN0aW9uX2RlcGFydG1lbnRfaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnaHJfc2VjdGlvbl9pZCcgPT4gJHNlY3Rpb24tPmhyX3NlY3Rpb25faWQsCiAgICAgICAgICAgICAgICAgICAgICAgIF0pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZihpc3NldCgkcHJpb3JpdGllc1swXSkpewogICAgICAgICAgICAgICAgICAgIFVzZXJQcmlvcml0eTo6aW5zZXJ0KCRwcmlvcml0aWVzKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAkdXNlci0+YXNzaWduUm9sZShSb2xlOjp3aGVyZUluKCduYW1lJywgJHJlcXVlc3QtPnJvbGVzKS0+cGx1Y2soJ25hbWUnKS0+dG9BcnJheSgpKTsKCiAgICAgICAgICAgICAgICBEQjo6Y29tbWl0KCk7CiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UoKS0+anNvbihbCiAgICAgICAgICAgICAgICAgICAgJ3N1Y2Nlc3MnID0+IHRydWUsCiAgICAgICAgICAgICAgICAgICAgJ3N0YXR1cycgPT4gdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAnc3RhdHVzX2NvZGUnID0+IDIwMCwKICAgICAgICAgICAgICAgICAgICAnZGF0YScgPT4gWwogICAgICAgICAgICAgICAgICAgICAgICAnbWVzc2FnZScgPT4gIlVzZXIgaGFzIGJlZW4gc3RvcmVkIHN1Y2Nlc3NmdWxseS4iCiAgICAgICAgICAgICAgICAgICAgXQogICAgICAgICAgICAgICAgXSwgMjAwKTsKICAgICAgICAgICAgfWNhdGNoIChcVGhyb3dhYmxlICR0aCl7CiAgICAgICAgICAgICAgICBEQjo6cm9sbGJhY2soKTsKICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKFsKICAgICAgICAgICAgICAgICAgICAnc3VjY2VzcycgPT4gZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgJ3N0YXR1cycgPT4gZmFsc2UsCiAgICAgICAgICAgICAgICAgICAgJ3N0YXR1c19jb2RlJyA9PiA1MDAsCiAgICAgICAgICAgICAgICAgICAgJ21lc3NhZ2UnID0+ICR0aC0+Z2V0TWVzc2FnZSgpCiAgICAgICAgICAgICAgICBdLCA1MDApOwogICAgICAgICAgICB9CiAgICAgICAgfQoKICAgICAgICByZXR1cm4gcmVzcG9uc2UoKS0+anNvbihbCiAgICAgICAgICAgICdzdWNjZXNzJyA9PiBmYWxzZSwKICAgICAgICAgICAgJ3N0YXR1cycgPT4gZmFsc2UsCiAgICAgICAgICAgICdzdGF0dXNfY29kZScgPT4gNDIyLAogICAgICAgICAgICAnZXJyb3JzJyA9PiAkdmFsaWRhdG9yLT5lcnJvcnMoKS0+YWxsKCkKICAgICAgICBdLCA0MjIpOwogICAgfQoKICAgIC8qKgogICAgICogVXNlciBEZXRhaWxzCiAgICAgKiAKICAgICAqIEdldCBVc2VyIGJ5IGl0J3MgdW5pcXVlIElELgogICAgICogCiAgICAgKiBAcXVlcnlQYXJhbSB0b2tlbiBzdHJpbmcgcmVxdWlyZWQgQXV0aGVudGljYXRpb24gVG9rZW4gTGlzdCB3b3VsZCBiZSBwcm92aWRlZCBieSBCSVpaU09MIEV4YW1wbGU6IGFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6YWJjZGVmCiAgICAgKiBAcGF0aFBhcmFtIHVzZXJfaWQgaW50IHJlcXVpcmVkIElEIG9mIHRoZSBVc2VyIEV4YW1wbGU6IDE3MTU2CiAgICAgKiAKICAgICAqIEBncm91cCBVc2VyCiAgICAgKiBAcGFyYW0gIGludCAgJGlkCiAgICAgKiBAcmV0dXJuIFxJbGx1bWluYXRlXEh0dHBcUmVzcG9uc2UKICAgICAqLwogICAgcHVibGljIGZ1bmN0aW9uIHNob3coVXNlciAkdXNlcikKICAgIHsKICAgICAgICB0cnl7CiAgICAgICAgICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKFsKICAgICAgICAgICAgICAgICdzdWNjZXNzJyA9PiB0cnVlLAogICAgICAgICAgICAgICAgJ3N0YXR1cycgPT4gdHJ1ZSwKICAgICAgICAgICAgICAgICdzdGF0dXNfY29kZScgPT4gMjAwLAogICAgICAgICAgICAgICAgJ2RhdGEnID0+IFsKICAgICAgICAgICAgICAgICAgICAndXNlcicgPT4gWwogICAgICAgICAgICAgICAgICAgICAgICAnaWQnID0+ICR1c2VyLT5pZCwKICAgICAgICAgICAgICAgICAgICAgICAgJ3VpZCcgPT4gJHVzZXItPmFzc29jaWF0ZV9pZCwKICAgICAgICAgICAgICAgICAgICAgICAgJ25hbWUnID0+ICR1c2VyLT5uYW1lLAogICAgICAgICAgICAgICAgICAgICAgICAnZGVzaWduYXRpb24nID0+IGlzc2V0KCR1c2VyLT5lbXBsb3llZS0+ZGVzaWduYXRpb24tPmhyX2Rlc2lnbmF0aW9uX25hbWUpID8gJHVzZXItPmVtcGxveWVlLT5kZXNpZ25hdGlvbi0+aHJfZGVzaWduYXRpb25fbmFtZSA6ICcnLAogICAgICAgICAgICAgICAgICAgICAgICAnZW1haWwnID0+ICR1c2VyLT5lbWFpbCwKICAgICAgICAgICAgICAgICAgICAgICAgJ3Bob25lJyA9PiAkdXNlci0+cGhvbmUsCiAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAndW5pdHMnID0+ICR1c2VyLT5wcmlvcml0aWVzLT5wbHVjaygndW5pdC5ocl91bml0X25hbWUnLCAndW5pdC5ocl91bml0X2lkJyktPnRvQXJyYXkoKSwKICAgICAgICAgICAgICAgICAgICAgICAgJ2RlcGFydG1lbnRzJyA9PiAkdXNlci0+cHJpb3JpdGllcy0+cGx1Y2soJ2RlcGFydG1lbnQuaHJfZGVwYXJ0bWVudF9uYW1lJywgJ2RlcGFydG1lbnQuaHJfZGVwYXJ0bWVudF9pZCcpLT50b0FycmF5KCksCiAgICAgICAgICAgICAgICAgICAgICAgICdzZWN0aW9ucycgPT4gJHVzZXItPnByaW9yaXRpZXMtPnBsdWNrKCdzZWN0aW9uLmhyX3NlY3Rpb25fbmFtZScsICdzZWN0aW9uLmhyX3NlY3Rpb25faWQnKS0+dG9BcnJheSgpLAoKICAgICAgICAgICAgICAgICAgICAgICAgJ2NvbXBhbmllcycgPT4gJHVzZXItPmNvbXBhbmllcy0+cGx1Y2soJ2NvbXBhbnkubmFtZScpLT5pbXBsb2RlKCcsICcpLAogICAgICAgICAgICAgICAgICAgICAgICAnY29zdENlbnRyZXMnID0+ICR1c2VyLT5jb3N0Q2VudHJlcy0+cGx1Y2soJ2Nvc3RDZW50cmUubmFtZScpLT5pbXBsb2RlKCcsICcpLAoKICAgICAgICAgICAgICAgICAgICAgICAgJ3JvbGVzJyA9PiAkdXNlci0+cm9sZXMtPnBsdWNrKCduYW1lJyktPnRvQXJyYXkoKQogICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgXSwgMjAwKTsKICAgICAgICB9Y2F0Y2ggKFxUaHJvd2FibGUgJHRoKXsKICAgICAgICAgICAgcmV0dXJuIHJlc3BvbnNlKCktPmpzb24oWwogICAgICAgICAgICAgICAgJ3N1Y2Nlc3MnID0+IGZhbHNlLAogICAgICAgICAgICAgICAgJ3N0YXR1cycgPT4gZmFsc2UsCiAgICAgICAgICAgICAgICAnc3RhdHVzX2NvZGUnID0+IDUwMCwKICAgICAgICAgICAgICAgICdtZXNzYWdlJyA9PiAkdGgtPmdldE1lc3NhZ2UoKQogICAgICAgICAgICBdLCA1MDApOwogICAgICAgIH0KICAgIH0KCiAgICAvKioKICAgICAqIFVwZGF0ZSBVc2VyCiAgICAgKiAKICAgICAqIFVwZGF0ZSBhbiBhdmFpbGFibGUgVXNlci4KICAgICAqIAogICAgICogQHF1ZXJ5UGFyYW0gdG9rZW4gc3RyaW5nIHJlcXVpcmVkIEF1dGhlbnRpY2F0aW9uIFRva2VuIExpc3Qgd291bGQgYmUgcHJvdmlkZWQgYnkgQklaWlNPTCBFeGFtcGxlOiBhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5emFiY2RlZgogICAgICogQHBhdGhQYXJhbSB1c2VyX2lkIGludCByZXF1aXJlZCBJRCBvZiB0aGUgVXNlciBFeGFtcGxlOiAxNzE1NgogICAgICogQGJvZHlQYXJhbSBuYW1lIHN0cmluZyByZXF1aXJlZCBOYW1lIG9mIHRoZSBVc2VyIEV4YW1wbGU6IEpvaG4gRG9lCiAgICAgKiBAYm9keVBhcmFtIHVpZCBzdHJpbmcgcmVxdWlyZWQgVUlEIG9mIHRoZSBVc2VyIEV4YW1wbGU6IDEwMDEKICAgICAqIEBib2R5UGFyYW0gZW1haWwgZW1haWwgcmVxdWlyZWQgRW1haWwgb2YgdGhlIFVzZXIgRXhhbXBsZTogZXhhbXBsZUBlbWFpbC5jb20KICAgICAqIEBib2R5UGFyYW0gcGhvbmUgc3RyaW5nIFBob25lIG9mIHRoZSBVc2VyIEV4YW1wbGU6IDAxMjM0NTY3ODkwCiAgICAgKiBAYm9keVBhcmFtIHVuaXRzIGFycmF5IHJlcXVpcmVkIEFycmF5IG9mIFVuaXRzIG9mIHRoZSBVc2VyIEV4YW1wbGU6IFsxLCAyLCAzXQogICAgICogQGJvZHlQYXJhbSBzZWN0aW9ucyBhcnJheSByZXF1aXJlZCBBcnJheSBvZiBTZWN0aW9ucyBvZiB0aGUgVXNlciBFeGFtcGxlOiBbMSwgMiwgM10KICAgICAqIEBib2R5UGFyYW0gcm9sZXMgYXJyYXkgcmVxdWlyZWQgQXJyYXkgb2YgUm9sZXMgb2YgdGhlIFVzZXIgRXhhbXBsZTogWyJBZG1pbiIsICJFbXBsb3llZSJdCiAgICAgKgogICAgICogQHJlc3BvbnNlIHsKICAgICAqICAgICAgICJzdWNjZXNzIjogdHJ1ZSwKICAgICAqICAgICAgICJzdGF0dXMiOiB0cnVlLAogICAgICogICAgICAgInN1Y2Nlc3NfY29kZSI6IDIwMCwKICAgICAqICAgICAgICJkYXRhIjogewogICAgICogICAgICAgICAgICJtZXNzYWdlIjogIlVzZXIgaGFzIGJlZW4gdXBkYXRlZCBzdWNjZXNzZnVsbHkuIgogICAgICogICAgICAgfQogICAgICogICB9CiAgICAgKiAKICAgICAqIEBncm91cCBVc2VyCiAgICAgKiBAcGFyYW0gIFxJbGx1bWluYXRlXEh0dHBcUmVxdWVzdCAgJHJlcXVlc3QKICAgICAqIEBwYXJhbSAgaW50ICAkaWQKICAgICAqIEByZXR1cm4gXElsbHVtaW5hdGVcSHR0cFxSZXNwb25zZQogICAgICovCiAgICBwdWJsaWMgZnVuY3Rpb24gdXBkYXRlKFJlcXVlc3QgJHJlcXVlc3QsICRpZCkKICAgIHsKICAgICAgICAkdmFsaWRhdG9yID0gXFZhbGlkYXRvcjo6bWFrZSgkcmVxdWVzdC0+YWxsKCksIFsKICAgICAgICAgICAgJ25hbWUnID0+ICdyZXF1aXJlZCcsCiAgICAgICAgICAgICd1aWQnID0+ICdyZXF1aXJlZCcsCiAgICAgICAgICAgICdlbWFpbCcgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgJ3NlY3Rpb25zJyA9PiAncmVxdWlyZWQnLAogICAgICAgICAgICAnc2VjdGlvbnMuKicgPT4gJ3JlcXVpcmVkJywKICAgICAgICAgICAgJ3JvbGVzJyA9PiAncmVxdWlyZWQnLAogICAgICAgICAgICAncm9sZXMuKicgPT4gJ3JlcXVpcmVkJywKICAgICAgICBdKTsKCiAgICAgICAgaWYgKCR2YWxpZGF0b3ItPnBhc3NlcygpKSB7CiAgICAgICAgICAgIERCOjpiZWdpblRyYW5zYWN0aW9uKCk7CiAgICAgICAgICAgIHRyeXsKICAgICAgICAgICAgICAgICR1c2VyID0gVXNlcjo6dXBkYXRlT3JDcmVhdGUoWwogICAgICAgICAgICAgICAgICAgICdhc19pZCcgPT4gJGlkCiAgICAgICAgICAgICAgICBdLCBbCiAgICAgICAgICAgICAgICAgICAgJ25hbWUnID0+ICRyZXF1ZXN0LT5uYW1lLAogICAgICAgICAgICAgICAgICAgICdhc3NvY2lhdGVfaWQnID0+ICRyZXF1ZXN0LT51aWQsCiAgICAgICAgICAgICAgICAgICAgJ2VtYWlsJyA9PiAkcmVxdWVzdC0+ZW1haWwsCiAgICAgICAgICAgICAgICAgICAgJ3Bob25lJyA9PiAkcmVxdWVzdC0+cGhvbmUsCiAgICAgICAgICAgICAgICBdKTsKCiAgICAgICAgICAgICAgICAkcHJpb3JpdGllcyA9IFtdOwogICAgICAgICAgICAgICAgVXNlclByaW9yaXR5Ojp3aGVyZSgndXNlcl9pZCcsICR1c2VyLT5pZCktPmRlbGV0ZSgpOwogICAgICAgICAgICAgICAgaWYoaXNzZXQoJHJlcXVlc3QtPnNlY3Rpb25zWzBdKSl7CiAgICAgICAgICAgICAgICAgICAgZm9yZWFjaCgkcmVxdWVzdC0+c2VjdGlvbnMgYXMgJGtleSA9PiAkaHJfc2VjdGlvbl9pZCl7CiAgICAgICAgICAgICAgICAgICAgICAgICRzZWN0aW9uID0gU2VjdGlvbjo6d2l0aChbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnZGVwYXJ0bWVudCcKICAgICAgICAgICAgICAgICAgICAgICAgXSktPmZpbmQoJGhyX3NlY3Rpb25faWQpOwogICAgICAgICAgICAgICAgICAgICAgICBhcnJheV9wdXNoKCRwcmlvcml0aWVzLCBbCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAndXNlcl9pZCcgPT4gJHVzZXItPmlkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2hyX3VuaXRfaWQnID0+ICRzZWN0aW9uLT5kZXBhcnRtZW50LT5ocl91bml0X2lkLAogICAgICAgICAgICAgICAgICAgICAgICAgICAgJ2hyX2RlcGFydG1lbnRfaWQnID0+ICRzZWN0aW9uLT5ocl9zZWN0aW9uX2RlcGFydG1lbnRfaWQsCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAnaHJfc2VjdGlvbl9pZCcgPT4gJHNlY3Rpb24tPmhyX3NlY3Rpb25faWQsCiAgICAgICAgICAgICAgICAgICAgICAgIF0pOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICBpZihpc3NldCgkcHJpb3JpdGllc1swXSkpewogICAgICAgICAgICAgICAgICAgIFVzZXJQcmlvcml0eTo6aW5zZXJ0KCRwcmlvcml0aWVzKTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAkdXNlci0+YXNzaWduUm9sZShSb2xlOjp3aGVyZUluKCduYW1lJywgJHJlcXVlc3QtPnJvbGVzKS0+cGx1Y2soJ25hbWUnKS0+dG9BcnJheSgpKTsKCiAgICAgICAgICAgICAgICBEQjo6Y29tbWl0KCk7CiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UoKS0+anNvbihbCiAgICAgICAgICAgICAgICAgICAgJ3N1Y2Nlc3MnID0+IHRydWUsCiAgICAgICAgICAgICAgICAgICAgJ3N0YXR1cycgPT4gdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAnc3RhdHVzX2NvZGUnID0+IDIwMCwKICAgICAgICAgICAgICAgICAgICAnZGF0YScgPT4gWwogICAgICAgICAgICAgICAgICAgICAgICAnbWVzc2FnZScgPT4gIlVzZXIgaGFzIGJlZW4gdXBkYXRlZCBzdWNjZXNzZnVsbHkuIgogICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgIF0sIDIwMCk7CiAgICAgICAgICAgIH1jYXRjaCAoXFRocm93YWJsZSAkdGgpewogICAgICAgICAgICAgICAgREI6OnJvbGxiYWNrKCk7CiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UoKS0+anNvbihbCiAgICAgICAgICAgICAgICAgICAgJ3N1Y2Nlc3MnID0+IGZhbHNlLAogICAgICAgICAgICAgICAgICAgICdzdGF0dXMnID0+IGZhbHNlLAogICAgICAgICAgICAgICAgICAgICdzdGF0dXNfY29kZScgPT4gNTAwLAogICAgICAgICAgICAgICAgICAgICdtZXNzYWdlJyA9PiAkdGgtPmdldE1lc3NhZ2UoKQogICAgICAgICAgICAgICAgXSwgNTAwKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlKCktPmpzb24oWwogICAgICAgICAgICAnc3VjY2VzcycgPT4gZmFsc2UsCiAgICAgICAgICAgICdzdGF0dXMnID0+IGZhbHNlLAogICAgICAgICAgICAnc3RhdHVzX2NvZGUnID0+IDQyMiwKICAgICAgICAgICAgJ2Vycm9ycycgPT4gJHZhbGlkYXRvci0+ZXJyb3JzKCktPmFsbCgpCiAgICAgICAgXSwgNDIyKTsKICAgIH0KCiAgICAvKioKICAgICAqIERlbGV0ZSBVc2VyCiAgICAgKiAKICAgICAqIERlbGV0ZSBhbiBhdmFpbGFibGUgVXNlci4KICAgICAqIAogICAgICogQHF1ZXJ5UGFyYW0gdG9rZW4gc3RyaW5nIHJlcXVpcmVkIEF1dGhlbnRpY2F0aW9uIFRva2VuIExpc3Qgd291bGQgYmUgcHJvdmlkZWQgYnkgQklaWlNPTCBFeGFtcGxlOiBhYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5emFiY2RlZgogICAgICogQHBhdGhQYXJhbSB1c2VyX2lkIGludCByZXF1aXJlZCBVbmlxdWUgSUQgb2YgdGhlIFVzZXIgRXhhbXBsZTogMTAwCiAgICAgKgogICAgICogQHJlc3BvbnNlIHsKICAgICAqICAgICAgICJzdWNjZXNzIjogdHJ1ZSwKICAgICAqICAgICAgICJzdGF0dXMiOiB0cnVlLAogICAgICogICAgICAgInN1Y2Nlc3NfY29kZSI6IDIwMCwKICAgICAqICAgICAgICJkYXRhIjogewogICAgICogICAgICAgICAgICJtZXNzYWdlIjogIlVzZXIgaGFzIGJlZW4gRGVsZXRlZCBzdWNjZXNzZnVsbHkuIgogICAgICogICAgICAgfQogICAgICogICB9CiAgICAgKiAKICAgICAqIEBncm91cCBVc2VyCiAgICAgKiBAcGFyYW0gIGludCAgJGlkCiAgICAgKiBAcmV0dXJuIFxJbGx1bWluYXRlXEh0dHBcUmVzcG9uc2UKICAgICAqLwogICAgcHVibGljIGZ1bmN0aW9uIGRlc3Ryb3koJGlkKQogICAgewogICAgICAgIERCOjpiZWdpblRyYW5zYWN0aW9uKCk7CiAgICAgICAgdHJ5ewoKICAgICAgICAgICAgJHVzZXIgPSBVc2VyOjpmaW5kKCRpZCk7CiAgICAgICAgICAgICR1c2VyLT5hc3NpZ25Sb2xlKFtdKTsKICAgICAgICAgICAgJHVzZXItPmRlbGV0ZSgpOwoKICAgICAgICAgICAgREI6OmNvbW1pdCgpOwogICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UoKS0+anNvbihbCiAgICAgICAgICAgICAgICAnc3VjY2VzcycgPT4gdHJ1ZSwKICAgICAgICAgICAgICAgICdzdGF0dXMnID0+IHRydWUsCiAgICAgICAgICAgICAgICAnc3RhdHVzX2NvZGUnID0+IDIwMCwKICAgICAgICAgICAgICAgICdkYXRhJyA9PiBbCiAgICAgICAgICAgICAgICAgICAgJ21lc3NhZ2UnID0+ICJVc2VyIGhhcyBiZWVuIGRlbGV0ZWQgc3VjY2Vzc2Z1bGx5LiIKICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgXSwgMjAwKTsKICAgICAgICB9Y2F0Y2ggKFxUaHJvd2FibGUgJHRoKXsKICAgICAgICAgICAgREI6OnJvbGxiYWNrKCk7CiAgICAgICAgICAgIHJldHVybiByZXNwb25zZSgpLT5qc29uKFsKICAgICAgICAgICAgICAgICdzdWNjZXNzJyA9PiBmYWxzZSwKICAgICAgICAgICAgICAgICdzdGF0dXMnID0+IGZhbHNlLAogICAgICAgICAgICAgICAgJ3N0YXR1c19jb2RlJyA9PiA1MDAsCiAgICAgICAgICAgICAgICAnbWVzc2FnZScgPT4gJHRoLT5nZXRNZXNzYWdlKCkKICAgICAgICAgICAgXSwgNTAwKTsKICAgICAgICB9CiAgICB9CgogICAgLyoqCiAgICAgKiBVcGRhdGUgVXNlciBQYXNzd29yZAogICAgICogCiAgICAgKiBAcXVlcnlQYXJhbSB0b2tlbiBzdHJpbmcgcmVxdWlyZWQgQXV0aGVudGljYXRpb24gVG9rZW4gTGlzdCB3b3VsZCBiZSBwcm92aWRlZCBieSBCSVpaU09MIEV4YW1wbGU6IGFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6YWJjZGVmCiAgICAgKiBAcGF0aFBhcmFtIHVzZXJfaWQgaW50IHJlcXVpcmVkIFVuaXF1ZSBJRCBvZiB0aGUgVXNlciBFeGFtcGxlOiBKb2huIERvZQogICAgICogQGJvZHlQYXJhbSBwYXNzd29yZCBzdHJpbmcgcmVxdWlyZWQgUGFzc3dvcmQgb2YgdGhlIFVzZXIgRXhhbXBsZTogMTIzNDU2NzgKICAgICAqIEBib2R5UGFyYW0gcGFzc3dvcmRfY29uZmlybWF0aW9uIHN0cmluZyByZXF1aXJlZCBQYXNzd29yZCBDb25maXJtYXRpb24gb2YgdGhlIFVzZXIgRXhhbXBsZTogMTIzNDU2NzgKICAgICAqCiAgICAgKiBAcmVzcG9uc2UgewogICAgICogICAgICAgInN1Y2Nlc3MiOiB0cnVlLAogICAgICogICAgICAgInN0YXR1cyI6IHRydWUsCiAgICAgKiAgICAgICAic3VjY2Vzc19jb2RlIjogMjAwLAogICAgICogICAgICAgImRhdGEiOiB7CiAgICAgKiAgICAgICAgICAgIm1lc3NhZ2UiOiAiVXNlciBQYXNzd29yZCBoYXMgYmVlbiBVcGRhdGVkIHN1Y2Nlc3NmdWxseS4iCiAgICAgKiAgICAgICB9CiAgICAgKiAgIH0KICAgICAqIAogICAgICogQGdyb3VwIFVzZXIKICAgICAqIEBwYXJhbSAgXElsbHVtaW5hdGVcSHR0cFxSZXF1ZXN0ICAkcmVxdWVzdAogICAgICogQHJldHVybiBcSWxsdW1pbmF0ZVxIdHRwXFJlc3BvbnNlCiAgICAgKi8KICAgIHB1YmxpYyBmdW5jdGlvbiB1cGRhdGVQYXNzd29yZChSZXF1ZXN0ICRyZXF1ZXN0LCAkaWQpCiAgICB7CiAgICAgICAgJHZhbGlkYXRvciA9IFxWYWxpZGF0b3I6Om1ha2UoJHJlcXVlc3QtPmFsbCgpLCBbCiAgICAgICAgICAgICdwYXNzd29yZCcgPT4gJ3JlcXVpcmVkfG1pbjo2fGNvbmZpcm1lZCcsCiAgICAgICAgXSk7CgogICAgICAgIGlmICgkdmFsaWRhdG9yLT5wYXNzZXMoKSkgewogICAgICAgICAgICBEQjo6YmVnaW5UcmFuc2FjdGlvbigpOwogICAgICAgICAgICB0cnl7CiAgICAgICAgICAgICAgICBVc2VyOjp1cGRhdGVPckNyZWF0ZShbCiAgICAgICAgICAgICAgICAgICAgJ2FzX2lkJyA9PiAkaWQKICAgICAgICAgICAgICAgIF0sWwogICAgICAgICAgICAgICAgICAgICdwYXNzd29yZCcgPT4gYmNyeXB0KCRyZXF1ZXN0LT5wYXNzd29yZCksCiAgICAgICAgICAgICAgICBdKTsKCiAgICAgICAgICAgICAgICBEQjo6Y29tbWl0KCk7CiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UoKS0+anNvbihbCiAgICAgICAgICAgICAgICAgICAgJ3N1Y2Nlc3MnID0+IHRydWUsCiAgICAgICAgICAgICAgICAgICAgJ3N0YXR1cycgPT4gdHJ1ZSwKICAgICAgICAgICAgICAgICAgICAnc3RhdHVzX2NvZGUnID0+IDIwMCwKICAgICAgICAgICAgICAgICAgICAnZGF0YScgPT4gWwogICAgICAgICAgICAgICAgICAgICAgICAnbWVzc2FnZScgPT4gIlVzZXIgcGFzc3dvcmQgaGFzIGJlZW4gdXBkYXRlZCBzdWNjZXNzZnVsbHkuIgogICAgICAgICAgICAgICAgICAgIF0KICAgICAgICAgICAgICAgIF0sIDIwMCk7CiAgICAgICAgICAgIH1jYXRjaCAoXFRocm93YWJsZSAkdGgpewogICAgICAgICAgICAgICAgREI6OnJvbGxiYWNrKCk7CiAgICAgICAgICAgICAgICByZXR1cm4gcmVzcG9uc2UoKS0+anNvbihbCiAgICAgICAgICAgICAgICAgICAgJ3N1Y2Nlc3MnID0+IGZhbHNlLAogICAgICAgICAgICAgICAgICAgICdzdGF0dXMnID0+IGZhbHNlLAogICAgICAgICAgICAgICAgICAgICdzdGF0dXNfY29kZScgPT4gNTAwLAogICAgICAgICAgICAgICAgICAgICdtZXNzYWdlJyA9PiAkdGgtPmdldE1lc3NhZ2UoKQogICAgICAgICAgICAgICAgXSwgNTAwKTsKICAgICAgICAgICAgfQogICAgICAgIH0KCiAgICAgICAgcmV0dXJuIHJlc3BvbnNlKCktPmpzb24oWwogICAgICAgICAgICAnc3VjY2VzcycgPT4gZmFsc2UsCiAgICAgICAgICAgICdzdGF0dXMnID0+IGZhbHNlLAogICAgICAgICAgICAnc3RhdHVzX2NvZGUnID0+IDQyMiwKICAgICAgICAgICAgJ2Vycm9ycycgPT4gJHZhbGlkYXRvci0+ZXJyb3JzKCktPmFsbCgpCiAgICAgICAgXSwgNDIyKTsKICAgIH0KfQo=